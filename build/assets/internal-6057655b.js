import{_ as ee,e as fe,c as _e}from"./index-eb73e870.js";import{R as f,r as b}from"./index-2c36b58a.js";import"./ResizeObserver-6fd345a6.js";import{u as Ie}from"./context-d1fbdd85.js";import{I as Ke}from"./internal-1dcf455f.js";import{u as Pe}from"./form-field-context-fcff921e.js";import{b as A,f as ge}from"./index-491afaa4.js";import{K as Y}from"./keycode-5e563e63.js";import{n as he}from"./node-belongs-c9e88748.js";import{D as Be}from"./index-aa0176b5.js";import{c as je,d as ke,g as He,S as We,b as Se,a as Ue,u as Ne,D as we}from"./use-highlight-option-7a4dfde2.js";import{u as Z}from"./index-5c04613c.js";import{O as xe}from"./index-039e8e61.js";import{f as qe}from"./scrollable-containers-435d5d18.js";import{O as Ge}from"./index-7771e8e2.js";import{u as Ve}from"./use-container-query-60e26c9e.js";const pe={"dropdown-footer":"awsui_dropdown-footer_vm8qf_jxdvh_5","dropdown-content":"awsui_dropdown-content_vm8qf_jxdvh_10"},ze=f.forwardRef((e,o)=>{var{value:a,onChange:s,onBlur:t,onFocus:p,onKeyUp:i,onKeyDown:c,name:u,placeholder:n,disabled:l,readOnly:h,autoFocus:g,ariaLabel:v,ariaRequired:y,disableBrowserAutocorrect:C=!1,expandToViewport:w,ariaControls:R,ariaActivedescendant:x,clearAriaLabel:T,dropdownExpanded:m=!0,dropdownContentKey:E,dropdownContentFocusable:k=!1,dropdownContent:B=null,dropdownFooter:G=null,dropdownWidth:V,loopFocus:te,onCloseDropdown:oe,onDelayedInput:ne,onPressArrowDown:H,onPressArrowUp:_,onPressEnter:D,__internalRootRef:W}=e,z=ee(e,["value","onChange","onBlur","onFocus","onKeyUp","onKeyDown","name","placeholder","disabled","readOnly","autoFocus","ariaLabel","ariaRequired","disableBrowserAutocorrect","expandToViewport","ariaControls","ariaActivedescendant","clearAriaLabel","dropdownExpanded","dropdownContentKey","dropdownContentFocusable","dropdownContent","dropdownFooter","dropdownWidth","loopFocus","onCloseDropdown","onDelayedInput","onPressArrowDown","onPressArrowUp","onPressEnter","__internalRootRef"]);const $=fe(z),re=Pe(z),O=b.useRef(null),L=b.useRef(null),M=b.useRef(null),S=b.useRef(!1),U=b.useRef(!1),[I,Q]=b.useState(!1),K=()=>!h&&Q(!0),j=()=>{Q(!1),A(oe,null)};b.useImperativeHandle(o,()=>({focus(r){var F;r!=null&&r.preventDropdown&&(S.current=!0),(F=O.current)===null||F===void 0||F.focus()},select(){var r;(r=O.current)===null||r===void 0||r.select()},open:K,close:j}));const se=()=>{U.current||(j(),A(t,null))},ie=()=>{S.current||(K(),A(p,null)),S.current=!1},N=r=>ge(c,r.detail,r),ae=r=>{switch(r.detail.keyCode){case Y.down:{H==null||H(),K(),r.preventDefault();break}case Y.up:{_==null||_(),K(),r.preventDefault();break}case Y.enter:{I&&(D!=null&&D()||j(),r.preventDefault()),N(r);break}case Y.escape:{I?(r.stopPropagation(),j()):a&&(r.stopPropagation(),A(s,{value:""})),r.preventDefault(),N(r);break}default:N(r)}},le=r=>{K(),A(s,{value:r})},de=r=>{A(ne,{value:r})},ce=r=>{k?(U.current=!0,requestAnimationFrame(()=>{U.current=!1})):r.preventDefault()},X={name:u,placeholder:n,autoFocus:g,onClick:K,role:"combobox","aria-autocomplete":"list","aria-expanded":I&&m,"aria-controls":I?R:void 0,"aria-owns":I?R:void 0,"aria-label":v,"aria-activedescendant":x};return b.useEffect(()=>{if(!I)return;const r=F=>{!he(O.current,F.target)&&!he(L.current,F.target)&&!he(M.current,F.target)&&j()};return window.addEventListener("mousedown",r),()=>{window.removeEventListener("mousedown",r)}},[I]),f.createElement("div",Object.assign({},$,{className:_e($.className,pe.root),ref:W}),f.createElement(Be,{minWidth:V,stretchWidth:!V,stretchBeyondTriggerWidth:!0,contentKey:E,onFocus:ie,onBlur:se,trigger:f.createElement(Ke,Object.assign({type:"visualSearch",value:a,onChange:r=>le(r.detail.value),__onDelayedInput:r=>de(r.detail.value),onKeyDown:ae,onKeyUp:i,disabled:l,disableBrowserAutocorrect:C,readOnly:h,ariaRequired:y,clearAriaLabel:T,ref:O,autoComplete:!1,__nativeAttributes:X},re)),onMouseDown:ce,open:I&&(!!B||!!G),footer:M&&f.createElement("div",{ref:M,className:pe["dropdown-footer"]},G),expandToViewport:w,loopFocus:te},I&&B?f.createElement("div",{ref:L,className:pe["dropdown-content"]},B):null))}),$e=ze,Qe=({options:e=[],statusType:o,onLoadItems:a})=>{const s=b.useRef(null),t=({firstPage:n,samePage:l,filteringText:h})=>{var g;(h===void 0||s.current!==h)&&(h!==void 0&&(s.current=h),a({filteringText:(g=s.current)!==null&&g!==void 0?g:"",firstPage:n,samePage:l}))};return{fireLoadMoreOnScroll:()=>{e.length>0&&o==="pending"&&t({firstPage:!1,samePage:!1})},fireLoadMoreOnRecoveryClick:()=>t({firstPage:!1,samePage:!0}),fireLoadMoreOnInputFocus:()=>{var n;return t({firstPage:!0,samePage:!1,filteringText:(n=s.current)!==null&&n!==void 0?n:""})},fireLoadMoreOnInputChange:n=>t({firstPage:!0,samePage:!1,filteringText:n})}},Te=e=>"type"in e&&e.type==="parent",Oe=e=>{if(e.length){const o=e[e.length-1];Te(o)&&e.pop()}},Je=(e,o)=>{const a=e.reduce((s,t)=>(Te(t)?(Oe(s),s.push(t)):Xe(t,o)&&s.push(t),s),[]);return Oe(a),a},Xe=(e,o)=>{const a=["value","label","description","labelTag"],s=["tags","filteringTags"],t=o.toLowerCase(),p=c=>Ce(e[c],t),i=c=>{var u;return(u=e[c])===null||u===void 0?void 0:u.some(n=>Ce(n,t))};return a.some(p)||s.some(i)},Ce=(e,o)=>e&&e.toLowerCase().indexOf(o)!==-1,Le=e=>!!e&&e.type!=="parent",Re=e=>!!e&&!e.disabled&&e.type!=="parent",Ye=({options:e,filterValue:o,filterText:a,filteringType:s,enteredTextLabel:t,hideEnteredTextLabel:p,onSelectItem:i})=>{const c=Ie("autosuggest"),[u,n]=b.useState(!1),{items:l,getItemGroup:h,getItemParent:g}=b.useMemo(()=>Ze(e),[e]),v=c("enteredTextLabel",t==null?void 0:t(o),m=>m({value:o})),y=b.useMemo(()=>{const m=s==="auto"&&!u?Je(l,a):[...l];return o&&!p&&m.unshift({value:o,type:"use-entered",label:v,option:{value:o}}),je(m,g),m},[s,u,l,a,o,p,g,v]),[C,w]=ke({options:y,isHighlightable:Le}),R=()=>{var m;return C.highlightedOption&&!Re(C.highlightedOption)?!1:(i((m=C.highlightedOption)!==null&&m!==void 0?m:{value:o,type:"use-entered",option:{value:o}}),!0)},x=m=>{y[m]&&Le(y[m])&&w.setHighlightedIndexWithMouse(m)},T=m=>{y[m]&&Re(y[m])&&i(y[m])};return[Object.assign(Object.assign({},C),{items:y,showAll:u,getItemGroup:h}),Object.assign(Object.assign({},w),{setShowAll:n,selectHighlightedOptionWithKeyboard:R,highlightVisibleOptionWithMouse:x,selectVisibleOptionWithMouse:T})]};function Ze(e){const o=[],a=new WeakMap,s=i=>a.get(i),t=i=>{var c;return(c=s(i))===null||c===void 0?void 0:c.option};for(const i of e)if(et(i))for(const c of p(i))o.push(c);else o.push(Object.assign(Object.assign({},i),{option:i}));function p(i){const{options:c}=i,u=ee(i,["options"]);let n=!0;const l=Object.assign(Object.assign({},u),{type:"parent",option:i}),h=[l];for(const g of c){g.disabled||(n=!1);const v=Object.assign(Object.assign({},g),{type:"child",disabled:g.disabled||u.disabled,option:g});h.push(v),a.set(v,l)}return h[0].disabled=h[0].disabled||n,h}return{items:o,getItemGroup:t,getItemParent:s}}function et(e){return"options"in e}const q={root:"awsui_root_12hwc_oboi4_5","layout-strut":"awsui_layout-strut_12hwc_oboi4_9","list-bottom":"awsui_list-bottom_12hwc_oboi4_15"},tt=(e,o)=>{var{nativeAttributes:a={},highlightText:s,option:t,highlighted:p,highlightType:i,current:c,virtualPosition:u,padBottom:n,screenReaderContent:l,ariaSetsize:h,ariaPosinset:g}=e,v=ee(e,["nativeAttributes","highlightText","option","highlighted","highlightType","current","virtualPosition","padBottom","screenReaderContent","ariaSetsize","ariaPosinset"]);const y=fe(v),C="type"in t&&t.type==="use-entered",w="type"in t&&t.type==="parent",R="type"in t&&t.type==="child",{throughIndex:x,inGroupIndex:T,groupIndex:m}=He(t)||{};let E;if(C)E=t.label,l=void 0;else if(w)E=t.label;else{const k={};a["aria-label"]&&(k["aria-label"]=a["aria-label"]),E=f.createElement("div",Object.assign({},k),f.createElement(Ge,{option:t,highlightedOption:p,highlightText:s}))}return f.createElement(We,Object.assign({},y,{className:q.option,ariaSelected:c,highlighted:p,disabled:t.disabled,hasBackground:C,isParent:w,isChild:R,virtualPosition:u,"data-test-index":x,"data-in-group-index":T,"data-group-index":m,ref:o,padBottom:n,screenReaderContent:l,ariaSetsize:h,ariaPosinset:g,highlightType:i.type,value:t.value}),E)},De=f.memo(f.forwardRef(tt)),Fe=(e,o,a,s,t,p)=>{const i=o===t?s:{},c=fe(i),u=e===a.length-1,n=a.length>1;return Object.assign({nativeAttributes:i,padBottom:!p&&n&&u},c)},ot=({autosuggestItemsState:e,handleLoadMore:o,menuProps:a,highlightedA11yProps:s,hasDropdownStatus:t,highlightText:p,listBottom:i,screenReaderContent:c})=>{const u=b.useRef(null);return b.useEffect(()=>{var n;const l=(n=u.current)===null||n===void 0?void 0:n.querySelector(`[data-mouse-target="${e.highlightedIndex}"]`);e.highlightType.moveFocus&&l&&qe(l)},[e.highlightType,e.highlightedIndex]),f.createElement(xe,Object.assign({},a,{onLoadMore:o,open:!0,ref:u}),e.items.map((n,l)=>{const h=Fe(l,n,e.items,s,e.highlightedOption,t);return f.createElement(De,Object.assign({highlightText:p,option:n,highlighted:n===e.highlightedOption,current:n.value===p,key:l,"data-mouse-target":l,screenReaderContent:c,highlightType:e.highlightType},h))}),i?f.createElement("li",{role:"option",className:q["list-bottom"]},i):null)},nt=ot,rt=({autosuggestItemsState:e,handleLoadMore:o,menuProps:a,highlightedA11yProps:s,hasDropdownStatus:t,highlightText:p,listBottom:i,screenReaderContent:c})=>{const u=b.useRef(null),[n,l]=Ve(g=>g.contentBoxWidth,[]);b.useImperativeHandle(l,()=>u.current);const h=Se({items:e.items,parentRef:u,estimateSize:b.useCallback(()=>31,[n,p])});return b.useEffect(()=>{e.highlightType.moveFocus&&h.scrollToIndex(e.highlightedIndex)},[e.highlightType,e.highlightedIndex,h]),f.createElement(xe,Object.assign({},a,{onLoadMore:o,ref:u,open:!0}),f.createElement("div",{"aria-hidden":"true",key:"total-size",className:q["layout-strut"],style:{height:h.totalSize+(e.items.length===1?1:0)}}),h.virtualItems.map(g=>{const{index:v,start:y,measureRef:C}=g,w=e.items[v],R=Fe(v,w,e.items,s,e.highlightedOption,t);return f.createElement(De,Object.assign({key:v,ref:C,highlightText:p,option:w,highlighted:w===e.highlightedOption,current:w.value===p,"data-mouse-target":v,virtualPosition:y+(v===0?1:0),screenReaderContent:c,ariaSetsize:e.items.length,ariaPosinset:v+1,highlightType:e.highlightType},R))}),i?f.createElement("li",{role:"option",className:q["list-bottom"]},i):null)},st=rt,Ae=e=>o=>{o>-1&&e(o)};function it({statusType:e,autosuggestItemsState:o,autosuggestItemsHandlers:a,highlightedOptionId:s,highlightText:t,listId:p,controlId:i,handleLoadMore:c,hasDropdownStatus:u,virtualScroll:n,selectedAriaLabel:l,renderHighlightedAriaLive:h,listBottom:g,ariaDescribedby:v}){var y;const C=Ae(a.selectVisibleOptionWithMouse),w=Ae(a.highlightVisibleOptionWithMouse),R=n?st:nt,x=Ue({announceSelected:((y=o.highlightedOption)===null||y===void 0?void 0:y.value)===t,highlightedOption:o.highlightedOption,getParent:T=>o.getItemGroup(T),selectedAriaLabel:l,renderHighlightedAriaLive:h});return f.createElement(R,{listBottom:g,handleLoadMore:c,autosuggestItemsState:o,highlightText:t,highlightedA11yProps:s?{id:s}:{},hasDropdownStatus:u,menuProps:{id:p,ariaLabelledby:i,onMouseUp:C,onMouseMove:w,ariaDescribedby:v,statusType:e},screenReaderContent:x})}const at=f.forwardRef((e,o)=>{var a,s;const{value:t,onChange:p,onBlur:i,onFocus:c,onKeyUp:u,onLoadItems:n,options:l,filteringType:h="auto",statusType:g="finished",placeholder:v,clearAriaLabel:y,name:C,disabled:w,disableBrowserAutocorrect:R=!1,autoFocus:x,readOnly:T,ariaLabel:m,ariaRequired:E,enteredTextLabel:k,filteringResultsText:B,onKeyDown:G,virtualScroll:V,expandToViewport:te,onSelect:oe,renderHighlightedAriaLive:ne,__internalRootRef:H}=e,_=ee(e,["value","onChange","onBlur","onFocus","onKeyUp","onLoadItems","options","filteringType","statusType","placeholder","clearAriaLabel","name","disabled","disableBrowserAutocorrect","autoFocus","readOnly","ariaLabel","ariaRequired","enteredTextLabel","filteringResultsText","onKeyDown","virtualScroll","expandToViewport","onSelect","renderHighlightedAriaLive","__internalRootRef"]),D=b.useRef(null);b.useImperativeHandle(o,()=>({focus:()=>{var d;return(d=D.current)===null||d===void 0?void 0:d.focus()},select:()=>{var d;return(d=D.current)===null||d===void 0?void 0:d.select()}}),[]);const W=Ie("autosuggest"),z=W("errorIconAriaLabel",_.errorIconAriaLabel),$=W("selectedAriaLabel",_.selectedAriaLabel),re=W("recoveryText",_.recoveryText);_.recoveryText;const[O,L]=Ye({options:l||[],filterValue:t,filterText:t,filteringType:h,enteredTextLabel:k,hideEnteredTextLabel:!1,onSelectItem:d=>{var ue;const ye=d.value||"";A(p,{value:ye}),A(oe,{value:ye,selectedOption:d.type!=="use-entered"?d.option:void 0}),(ue=D.current)===null||ue===void 0||ue.close()}}),M=Qe({options:l,statusType:g,onLoadItems:d=>A(n,d)}),S=d=>{L.setShowAll(!1),L.resetHighlightWithKeyboard(),A(p,d.detail)},U=d=>{M.fireLoadMoreOnInputChange(d.detail.value)},I=()=>{A(i,null)},Q=()=>{L.setShowAll(!0),M.fireLoadMoreOnInputFocus(),A(c,null)},K=d=>{ge(u,d.detail,d)},j=d=>{ge(G,d.detail,d)},se=()=>{if(O.items.length-1===O.highlightedIndex){L.goHomeWithKeyboard();return}L.moveHighlightWithKeyboard(1)},ie=()=>{var d;if(((d=O.highlightedOption)===null||d===void 0?void 0:d.type)==="child"&&O.highlightedIndex===1||O.highlightedIndex===0){L.goEndWithKeyboard();return}L.moveHighlightWithKeyboard(-1)},N=()=>L.selectHighlightedOptionWithKeyboard(),ae=()=>{L.resetHighlightWithKeyboard()},le=()=>{var d;M.fireLoadMoreOnRecoveryClick(),(d=D.current)===null||d===void 0||d.focus()},de=Pe(_),ce=Z("input"),J=Z("footer"),X=(a=de.controlId)!==null&&a!==void 0?a:ce,r=Z("list"),F=Z(),me=O.highlightedOption?F:void 0,ve=!t&&!O.items.length,be=!!t&&t.length!==0,Ee=be?B==null?void 0:B(O.items.length,(s=l==null?void 0:l.length)!==null&&s!==void 0?s:0):void 0,P=Ne(Object.assign(Object.assign({},e),{isEmpty:ve,isFiltered:be,recoveryText:re,errorIconAriaLabel:z,onRecoveryClick:le,filteringResultsText:Ee,hasRecoveryCallback:!!n})),Me=!ve||P.content;return f.createElement($e,Object.assign({},_,{className:_e(q.root,_.className),ref:D,__internalRootRef:H,value:t,onChange:S,onBlur:I,onFocus:Q,onKeyUp:K,onKeyDown:j,name:C,controlId:X,placeholder:v,disabled:w,readOnly:T,autoFocus:x,ariaLabel:m,ariaRequired:E,clearAriaLabel:y,disableBrowserAutocorrect:R,expandToViewport:te,ariaControls:r,ariaActivedescendant:me,dropdownExpanded:O.items.length>1||P.content!==null,dropdownContent:Me&&f.createElement(it,{statusType:g,autosuggestItemsState:O,autosuggestItemsHandlers:L,highlightedOptionId:me,highlightText:t,listId:r,controlId:X,handleLoadMore:M.fireLoadMoreOnScroll,hasDropdownStatus:P.content!==null,virtualScroll:V,selectedAriaLabel:$,renderHighlightedAriaLive:ne,listBottom:P.isSticky?null:f.createElement(we,{content:P.content,id:J}),ariaDescribedby:P.content?J:void 0}),dropdownFooter:P.isSticky&&P.content?f.createElement(we,{id:J,content:P.content,hasItems:O.items.length>=1}):null,loopFocus:P.hasRecoveryButton,onCloseDropdown:ae,onDelayedInput:U,onPressArrowDown:se,onPressArrowUp:ie,onPressEnter:N}))}),Rt=at;export{it as A,Rt as I,Qe as a,$e as b,q as c,Ye as u};
