import{r as n,R as S}from"./index-2c36b58a.js";import{n as A}from"./node-belongs-c9e88748.js";const C={navigationActive:!1,registerFocusable:()=>()=>{}},T=n.createContext(C);function _(d,e){var v;const{navigationActive:a,registerFocusable:g}=n.useContext(T),[l,F]=n.useState(!1),o=(e==null?void 0:e.tabIndex)&&(e==null?void 0:e.tabIndex)<0,u=a&&!o;n.useLayoutEffect(()=>{if(u&&d&&d.current){const s=g(d.current,f=>F(f));return()=>s()}});let c=e==null?void 0:e.tabIndex;return u&&(c=l?(v=e==null?void 0:e.tabIndex)!==null&&v!==void 0?v:0:-1),{navigationActive:u,tabIndex:c}}const k=n.forwardRef(({navigationActive:d,children:e,getNextFocusTarget:v,isElementSuppressed:a,onRegisterFocusable:g,onUnregisterActive:l},F)=>{const o=n.useRef(new Set),u=n.useRef(new Map),c=n.useRef(new WeakMap),s=n.useRef(null);function f(t){A(t,document.activeElement)&&setTimeout(()=>l==null?void 0:l(t),0)}function I(t,r){o.current.add(t),u.current.set(t,r);const x=!!c.current.get(t),i=s.current===t||!!(a!=null&&a(t));return i!==x&&(c.current.set(t,i),r(i)),g==null||g(t),()=>b(t)}function b(t){o.current.delete(t),u.current.delete(t),f==null||f(t)}function w(){var t;s.current=v();for(const r of o.current){const x=(t=c.current.get(r))!==null&&t!==void 0?t:!1,i=s.current===r||!!(a!=null&&a(r));i!==x&&(c.current.set(r,i),u.current.get(r)(i))}}function N(){return s.current}function R(t){return o.current.has(t)}return n.useImperativeHandle(F,()=>({updateFocusTarget:w,getFocusTarget:N,isRegistered:R})),S.createElement(T.Provider,{value:{navigationActive:d,registerFocusable:I}},e)});export{k as S,T as a,C as d,_ as u};
