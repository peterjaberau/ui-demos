import{a,r as u}from"./index-2c36b58a.js";import{u as c}from"./index-8f886a48.js";class f{constructor(t){this._listeners=[],this._state=t}get(){return this._state}set(t){const s=this._state,r=t(s);this._state=r,a.unstable_batchedUpdates(()=>{for(const[i,n]of this._listeners)i(s)!==i(r)&&n(r,s)})}subscribe(t,s){return this._listeners.push([t,s]),()=>this.unsubscribe(s)}unsubscribe(t){for(let s=0;s<this._listeners.length;s++){const[,r]=this._listeners[s];if(r===t){this._listeners.splice(s,1);break}}}}function o(e,t,s){u.useLayoutEffect(()=>e.subscribe(t,(i,n)=>s(t(i),t(n))),[e])}function l(e,t){const[s,r]=u.useState(t(e.get()));o(e,t,n=>{r(n)});const i=c(e);return i!==null&&i!==e?t(e.get()):s}export{f as A,o as a,l as u};
