import{_ as S,e as q,c}from"./index-eb73e870.js";import{R as r,r as t}from"./index-2c36b58a.js";import{u as $}from"./context-d1fbdd85.js";import{g as H}from"./utils-06561385.js";import{s as n,a as U,A as G,b as J,P as Q}from"./internal-1d1af924.js";import{L as X}from"./link-default-variant-context-309e3cd5.js";import{R as Y}from"./reset-contexts-for-modal-28d84991.js";import{u as Z}from"./single-tab-stop-navigation-context-cd355dd7.js";import{b as ee}from"./index-491afaa4.js";import{u as re}from"./index-33af1cce.js";import{u as te}from"./index-67c045b5.js";import{u as se}from"./index-5c04613c.js";import{K as E}from"./keycode-5e563e63.js";const ye=r.forwardRef(oe);function oe(b,_){var{position:w="right",size:A="medium",fixedWidth:I=!1,triggerType:i="text",dismissButton:u=!0,children:v,header:h,content:k,triggerAriaLabel:T,wrapTriggerText:L=!0,isInline:D=!1,renderWithPortal:l=!1,__onOpen:x,__internalRootRef:N=null,__closeAnalyticsAction:K}=b,y=S(b,["position","size","fixedWidth","triggerType","dismissButton","children","header","content","triggerAriaLabel","wrapTriggerText","isInline","renderWithPortal","__onOpen","__internalRootRef","__closeAnalyticsAction"]);const C=q(y),s=t.useRef(null),W=t.useRef(null),m=t.useRef(null),B=$("popover")("dismissAriaLabel",y.dismissAriaLabel),[f,a]=t.useState(!1),d=t.useCallback(()=>{var e,o;i==="text"?(e=s.current)===null||e===void 0||e.focus():s.current&&((o=H(s.current))===null||o===void 0||o.focus())},[i]),F=t.useCallback(()=>{ee(x),a(!0)},[x]),P=t.useCallback(()=>{a(!1),d()},[d]),O=t.useCallback(e=>{const o=e.keyCode===E.escape,j=e.keyCode===E.tab;o&&f&&e.stopPropagation(),(j||o)&&a(!1)},[f]);t.useImperativeHandle(_,()=>({dismissPopover:P,focus:()=>{a(!1),d()}})),t.useEffect(()=>{if(!s.current)return;const e=s.current.ownerDocument,o=()=>{m.current===null&&a(!1)};return e.addEventListener("mousedown",o),()=>{e.removeEventListener("mousedown",o)}},[]);const z=te(s),p={ref:s,onClick:F,onKeyDown:O,className:c(n.trigger,n[`trigger-type-${i}`])},{tabIndex:M}=Z(s),g=se(),R=r.createElement("div",{"aria-live":u?void 0:"polite","aria-atomic":u?void 0:!0,className:c(z,!l&&n["popover-inline-content"]),"data-awsui-referrer-id":g},f&&r.createElement(U,{size:A,fixedWidth:I,position:w,trackRef:s,arrow:e=>r.createElement(G,{position:e}),renderWithPortal:l,zIndex:l?7e3:void 0},r.createElement(X.Provider,{value:{defaultVariant:"primary"}},r.createElement(J,{dismissButton:u,dismissAriaLabel:B,header:h,onDismiss:P,overflowVisible:"both",closeAnalyticsAction:K},k)))),V=re(W,N);return r.createElement("span",Object.assign({},C,{className:c(n.root,C.className,i==="filtering-token"&&n["root-filtering-token"],D&&n["no-wrap"]),ref:V,onMouseDown:()=>{m.current=requestAnimationFrame(()=>{m.current=null})}}),i==="text"?r.createElement("button",Object.assign({},p,{className:c(p.className,L===!1&&n["overflow-ellipsis"]),tabIndex:M,type:"button","aria-haspopup":"dialog",id:g,"aria-label":T}),v):r.createElement("span",Object.assign({},p,{id:g}),v),r.createElement(Y,null,l?r.createElement(Q,null,R):R))}export{ye as I};
