import{j as F,r as l}from"./index-2c36b58a.js";import{F as p}from"./index-ad6ed501.js";function x(e,t){const r=B(e,t),o=j(t);return r?{errorText:r,fileErrors:o}:null}function B(e,t){const r=t.filter(n=>n.length>0).length,o=e.join(", "),s=r===0?"":r===1?"1 file has error(s)":`${r} files have errors`;return o&&s?`${o}, and ${s}`:o||s||null}function j(e){const t=e.map(r=>r.join(", ")??null);return t.filter(Boolean).length>0?t:void 0}function M({status:e}){switch(e){case"uploading":return F.jsx(p,{items:[{type:"info",loading:!0,header:"Uploading files",statusIconAriaLabel:"uploading",ariaRole:"status"}]});case"uploaded":return F.jsx(p,{items:[{type:"success",header:"Files uploaded",statusIconAriaLabel:"uploaded",ariaRole:"status"}]});case"submitted":return F.jsx(p,{items:[{type:"success",header:"Form submitted",statusIconAriaLabel:"submitted",ariaRole:"status"}]});default:return null}}function N(){const[e,t]=l.useState("pending"),[r,o]=l.useState(!1),[s,n]=l.useState([]),[i,c]=l.useState([]),[f,m]=l.useState(null),[b,v]=l.useState(""),[h,E]=l.useState(null);return l.useEffect(()=>{if(i.length===0){t("pending");return}t("uploading");const a=setTimeout(()=>{i.some(S)?(m(x([],i.map(d=>S(d)?["File was not accepted by server"]:[]))),t("error")):t("uploaded")},2e3);return()=>{clearTimeout(a)}},[i]),{status:r&&e!=="uploading"&&!f&&!h?"submitted":e,files:s,fileErrors:f,name:b,nameError:h,onFilesChange(a){n(a),o(!1),m(null)},onNameChange(a){v(a),o(!1),E(null)},onUploadFiles(a){c(a)},onSubmitForm(a,d){m(a),E(d),o(!f&&!d)}}}function S(e){return e.type.startsWith("image/")}const u={KB:1e3,MB:1e3**2};function $(e){const t=[],r=[],o=n=>{n&&t.push(n)},s=n=>{for(let i=0;i<e.length;i++){const c=n(e[i]);c&&(r[i]=[...r[i]??[],c])}};return o(z(e,1*u.MB)),s(n=>I(n,500*u.KB)),x(t,r)}function w(e){return e.length===0?{errorText:"No files selected",fileErrors:void 0}:$(e)}function g(e){return e<u.MB?`${(e/u.KB).toFixed(2)} KB`:`${(e/u.MB).toFixed(2)} MB`}function I(e,t){return e.size>t?`File size is above the allowed maximum (${g(t)})`:null}function z(e,t){const r=e.reduce((o,s)=>o+s.size,0);return r>t?`Files combined size (${g(r)}) is above the allowed maximum (${g(t)})`:null}export{M as P,w as a,N as u,$ as v};
