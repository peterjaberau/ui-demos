import{R as h,r as L,a as de}from"./index-2c36b58a.js";import{c as D}from"./index-eb73e870.js";import{a as ue}from"./use-resize-observer-2cd5ced9.js";import{a as R}from"./index-47bb06f7.js";import{b as O}from"./index-491afaa4.js";import{c as fe}from"./index-c328e31d.js";import{u as Se}from"./index-33af1cce.js";import{u as pe}from"./index-1b07c59a.js";import{u as me}from"./index-67c045b5.js";import{u as _e}from"./index-5c04613c.js";import{u as we}from"./index-84af6bb2.js";import{n as C}from"./node-belongs-c9e88748.js";import{g as F,a as Ee}from"./utils-06561385.js";import{T as U,d as he}from"./internal-1d1af924.js";import"./ResizeObserver-6fd345a6.js";import{b as ke}from"./breakpoints-dd8065be.js";import{e as Z,g as be}from"./scrollable-containers-435d5d18.js";const j=h.createContext({position:"bottom-right"});function ge({children:t,position:l="bottom-right"}){return h.createElement(j.Provider,{value:{position:l}},t)}function Ke(){return L.useContext(j)}const a={"dropdown-content-wrapper":"awsui_dropdown-content-wrapper_qwoo0_1nohd_153","awsui-motion-fade-in-dropdown":"awsui_awsui-motion-fade-in-dropdown_qwoo0_1nohd_1",refresh:"awsui_refresh_qwoo0_1nohd_174","awsui-motion-fade-in-0":"awsui_awsui-motion-fade-in-0_qwoo0_1nohd_1",root:"awsui_root_qwoo0_1nohd_199",interior:"awsui_interior_qwoo0_1nohd_232",dropdown:"awsui_dropdown_qwoo0_1nohd_153","use-portal":"awsui_use-portal_qwoo0_1nohd_243","is-empty":"awsui_is-empty_qwoo0_1nohd_289","dropdown-drop-up":"awsui_dropdown-drop-up_qwoo0_1nohd_296","with-limited-width":"awsui_with-limited-width_qwoo0_1nohd_300","dropdown-drop-left":"awsui_dropdown-drop-left_qwoo0_1nohd_303","dropdown-drop-right":"awsui_dropdown-drop-right_qwoo0_1nohd_306","occupy-entire-width":"awsui_occupy-entire-width_qwoo0_1nohd_309","stretch-beyond-trigger-width":"awsui_stretch-beyond-trigger-width_qwoo0_1nohd_312","hide-block-border":"awsui_hide-block-border_qwoo0_1nohd_319",open:"awsui_open_qwoo0_1nohd_328",nowrap:"awsui_nowrap_qwoo0_1nohd_337","dropdown-content":"awsui_dropdown-content_qwoo0_1nohd_153","stretch-trigger-height":"awsui_stretch-trigger-height_qwoo0_1nohd_348"},q=50,G=19,J=20,Ie=t=>be(t).map(n=>{const{blockSize:c,inlineSize:r,insetBlockStart:d,insetInlineStart:u}=R(n);return{blockSize:c,inlineSize:r,insetBlockStart:d,insetInlineStart:u}}).shift(),K=ke("xxs"),Q=({trigger:t,overflowParents:l,stretchWidth:n=!1,stretchHeight:c=!1,isMobile:r})=>{const d=c?0:r?G:q,u=n?0:r?J:q,{insetBlockEnd:f,insetInlineStart:S,insetInlineEnd:i}=R(t);return l.reduce(({blockStart:p,blockEnd:w,inlineStart:k,inlineEnd:o},m)=>{const _=f-m.insetBlockStart,I=_-t.offsetHeight-d,B=m.blockSize-_-d,v=i-m.insetInlineStart-u,A=m.insetInlineStart+m.inlineSize-S-u;return{blockStart:Math.min(p,I),blockEnd:Math.min(w,B),inlineStart:Math.min(k,v),inlineEnd:Math.min(o,A)}},{blockStart:Number.MAX_VALUE,blockEnd:Number.MAX_VALUE,inlineStart:Number.MAX_VALUE,inlineEnd:Number.MAX_VALUE})},Be=({trigger:t,overflowParents:l,isMobile:n})=>{const c=n?G:q,r=n?J:q,{insetBlockEnd:d,insetBlockStart:u,insetInlineStart:f,insetInlineEnd:S}=R(t);return l.reduce(({blockStart:i,blockEnd:p,inlineStart:w,inlineEnd:k},o)=>{const m=d-o.insetBlockStart-c,_=o.blockSize-u+o.insetBlockStart-c,I=f-o.insetInlineStart-r,B=o.insetInlineStart+o.inlineSize-S-r;return{blockStart:Math.min(i,m),blockEnd:Math.min(p,_),inlineStart:Math.min(w,I),inlineEnd:Math.min(k,B)}},{blockStart:Number.MAX_VALUE,blockEnd:Number.MAX_VALUE,inlineStart:Number.MAX_VALUE,inlineEnd:Number.MAX_VALUE})},Y=({triggerElement:t,dropdownElement:l,desiredMinWidth:n,stretchBeyondTriggerWidth:c=!1})=>{const{inlineSize:r}=R(t),d=n?Math.min(r,n):r,u=c?Math.max(K,r):Number.MAX_VALUE,{inlineSize:f}=R(l);return{idealWidth:Math.min(Math.max(f,d),u),minWidth:d,triggerInlineSize:r}},Le=({triggerElement:t,dropdownElement:l,desiredMinWidth:n,expandToViewport:c,stretchWidth:r,stretchHeight:d,isMobile:u})=>{const f=Z({element:l,excludeClosestParent:!1,expandToViewport:c,canExpandOutsideViewport:d}),{idealWidth:S}=Y({triggerElement:t,dropdownElement:l,desiredMinWidth:n,stretchBeyondTriggerWidth:!0}),i=Q({trigger:t,overflowParents:f,stretchWidth:r,stretchHeight:d,isMobile:u});return S<=i.inlineStart||S<=i.inlineEnd},ve=({triggerElement:t,dropdownElement:l,overflowParents:n,minWidth:c,preferCenter:r=!1,stretchWidth:d=!1,stretchHeight:u=!1,isMobile:f=!1,stretchBeyondTriggerWidth:S=!1})=>{const i=Q({trigger:t,overflowParents:n,stretchWidth:d,stretchHeight:u,isMobile:f}),{idealWidth:p,minWidth:w,triggerInlineSize:k}=Y({triggerElement:t,dropdownElement:l,desiredMinWidth:c,stretchBeyondTriggerWidth:S});let o,m=null,_=p;if(p<=i.inlineEnd?o=!1:p<=i.inlineStart?o=!0:(o=i.inlineStart>i.inlineEnd,_=Math.max(i.inlineStart,i.inlineEnd,w)),r){const A=(p-k)/2,y=i.inlineStart-k,N=i.inlineEnd-k;y>=A&&N>=A&&(m=-A)}const I=i.blockEnd<l.offsetHeight&&i.blockStart>i.blockEnd,B=I?i.blockStart:i.blockEnd,v=u?B:Math.floor(B/31)*31+16;return{dropBlockStart:I,dropInlineStart:o,insetInlineStart:m===null?"auto":`${m}px`,blockSize:`${v}px`,inlineSize:`${_}px`}},Ae=(t,l,n,c)=>{const r=Be({trigger:t,overflowParents:n,isMobile:c}),{insetBlockEnd:d,insetBlockStart:u,inlineSize:f}=R(t),{insetBlockStart:S,blockSize:i}=Ie(t);let p,{inlineSize:w}=R(l);const k=u-S;w<=r.inlineEnd?p=!1:w<=r.inlineStart?p=!0:(p=r.inlineStart>r.inlineEnd,w=Math.max(r.inlineStart,r.inlineEnd));const o=p?0-w:f,m=r.blockEnd<l.offsetHeight&&r.blockStart>r.blockEnd,_=m?S+i-d:0,I=m?r.blockStart:r.blockEnd,B=Math.floor(I/31)*31+16;return{dropBlockStart:m,dropInlineStart:p,blockSize:`${B}px`,inlineSize:`${w}px`,insetBlockStart:`${k}px`,insetBlockEnd:`${_}px`,insetInlineStart:`${o}px`}},Re=(t,l,n,c,r,d,u,f,S,i,p)=>{n.style.maxBlockSize="",t.style.inlineSize="",t.style.insetBlockStart="",t.style.insetBlockEnd="",t.style.insetInlineStart="",t.classList.remove(a["dropdown-drop-left"]),t.classList.remove(a["dropdown-drop-right"]),t.classList.remove(a["dropdown-drop-up"]);const w=Z({element:t,excludeClosestParent:c,expandToViewport:r,canExpandOutsideViewport:f}),k=c?Ae(l,t,w,S):ve({triggerElement:l,dropdownElement:t,overflowParents:w,minWidth:i,preferCenter:d,stretchWidth:u,stretchHeight:f,isMobile:S,stretchBeyondTriggerWidth:p}),o=l.getBoundingClientRect();return[k,o]},xe=({triggerRef:t,children:l,renderWithPortal:n,id:c,referrerId:r,open:d})=>{var u,f;if(!n)return h.createElement(h.Fragment,null,l);if(!d)return null;const S=(f=(u=t.current)===null||u===void 0?void 0:u.ownerDocument)!==null&&f!==void 0?f:document;return de.createPortal(h.createElement("div",{id:c,"data-awsui-referrer-id":r},l),S.body)},ye=({state:t,transitionRef:l,dropdownClasses:n,stretchWidth:c,interior:r,isRefresh:d,dropdownRef:u,verticalContainerRef:f,expandToViewport:S,stretchBeyondTriggerWidth:i,header:p,children:w,footer:k,position:o,open:m,onMouseDown:_,id:I,role:B,ariaLabelledby:v,ariaDescribedby:A})=>{const y=Se(u,l);return h.createElement("div",{className:D(a.dropdown,n,{[a.open]:m,[a["with-limited-width"]]:!c,[a["hide-block-border"]]:c,[a.interior]:r,[a.refresh]:d,[a["use-portal"]]:S&&!r,[a["stretch-beyond-trigger-width"]]:i}),ref:y,id:I,role:B,"aria-labelledby":v,"aria-describedby":A,"data-open":m,"data-animating":t!=="exited","aria-hidden":!m,style:i?{[fe.dropdownDefaultMaxWidth]:`${K}px`}:{},onMouseDown:_},h.createElement("div",{className:D(a["dropdown-content-wrapper"],!p&&!w&&a["is-empty"],d&&a.refresh)},h.createElement("div",{ref:f,className:a["dropdown-content"]},h.createElement(ge,{position:o},p,w,k))))},ze=({children:t,trigger:l,open:n,onDropdownClose:c,onMouseDown:r,header:d,footer:u,dropdownId:f,stretchTriggerHeight:S=!1,stretchWidth:i=!0,stretchHeight:p=!1,stretchToTriggerWidth:w=!0,stretchBeyondTriggerWidth:k=!1,expandToViewport:o=!1,preferCenter:m=!1,interior:_=!1,minWidth:I,scrollable:B=!0,loopFocus:v=o,onFocus:A,onBlur:y,contentKey:N,dropdownContentId:T,dropdownContentRole:ee,ariaLabelledby:te,ariaDescribedby:ne})=>{const $=L.useRef(null),g=L.useRef(null),E=L.useRef(null),P=L.useRef(null),x=L.useRef(null),z=L.useRef(null),re=we(),ie=me(g),[oe,M]=L.useState("bottom-right"),V=pe(),se=(e,b,s,W)=>{const ce=!_&&i;if(i?W.style.maxBlockSize=e.blockSize:W.style.maxBlockSize=`${parseInt(e.blockSize)+1}px`,ce&&!o?w&&s.classList.add(a["occupy-entire-width"]):s.style.inlineSize=e.inlineSize,e.dropBlockStart&&!_?(s.classList.add(a["dropdown-drop-up"]),o||(s.style.insetBlockEnd="100%")):s.classList.remove(a["dropdown-drop-up"]),s.classList.add(e.dropInlineStart?a["dropdown-drop-left"]:a["dropdown-drop-right"]),e.insetInlineStart&&e.insetInlineStart!=="auto"&&(s.style.insetInlineStart=e.insetInlineStart),o&&!_){s.style.position="fixed",e.dropBlockStart?s.style.insetBlockEnd=`calc(100% - ${b.top}px)`:s.style.insetBlockStart=`${b.bottom}px`,e.dropInlineStart?s.style.insetInlineStart=`calc(${b.right}px - ${e.inlineSize})`:s.style.insetInlineStart=`${b.left}px`,z.current=e;return}_&&Me(e)&&(e.dropBlockStart?s.style.insetBlockEnd=e.insetBlockEnd:s.style.insetBlockStart=e.insetBlockStart,s.style.insetInlineStart=e.insetInlineStart),e.dropBlockStart&&e.dropInlineStart?M("top-left"):e.dropBlockStart?M("top-right"):e.dropInlineStart?M("bottom-left"):M("bottom-right")},X=e=>(!$.current||!C($.current,e))&&(!P.current||!C(P.current,e)),le=e=>{(!e.relatedTarget||X(e.relatedTarget))&&O(A,e)},ae=e=>{(!e.relatedTarget||X(e.relatedTarget))&&O(y,e)};ue(()=>E.current,()=>{const e=a["stretch-beyond-trigger-width"];n&&k&&E.current&&g.current&&E.current.classList.contains(e)&&!Le({triggerElement:g.current,dropdownElement:E.current,desiredMinWidth:I,expandToViewport:o,stretchWidth:i,stretchHeight:p,isMobile:V})&&E.current.classList.remove(e)}),L.useLayoutEffect(()=>{const e=()=>{n&&E.current&&g.current&&x.current&&(B&&E.current.classList.add(a.nowrap),se(...Re(E.current,g.current,x.current,_,o,m,i,p,V,I,k),E.current,x.current),B&&E.current.classList.remove(a.nowrap))};if(e(),n){window.addEventListener("scroll",e);const b=setTimeout(()=>{window.removeEventListener("scroll",e)},500);return()=>{clearTimeout(b),window.removeEventListener("scroll",e)}}},[n,E,g,x,_,i,V,N]),L.useEffect(()=>{if(!n)return;const e=b=>{const s=b.composedPath?b.composedPath()[0]:b.target;!C(E.current,s)&&!C(g.current,s)&&O(c)};return window.addEventListener("click",e,!0),()=>{window.removeEventListener("click",e,!0)}},[n,c]),L.useLayoutEffect(()=>{if(!o||!n)return;const e=()=>{if(g.current&&E.current&&x.current){const b=R(g.current),s=E.current;z.current&&(z.current.dropBlockStart?E.current.style.insetBlockEnd=`calc(100% - ${b.insetBlockStart}px)`:s.style.insetBlockStart=`${b.insetBlockEnd}px`,z.current.dropInlineStart?s.style.insetInlineStart=`calc(${b.insetInlineEnd}px - ${z.current.inlineSize})`:s.style.insetInlineStart=`${b.insetInlineStart}px`)}};return e(),window.addEventListener("scroll",e,!0),window.addEventListener("resize",e,!0),()=>{window.removeEventListener("scroll",e,!0),window.removeEventListener("resize",e,!0)}},[n,o]);const H=_e();return h.createElement("div",{className:D(a.root,_&&a.interior,S&&a["stretch-trigger-height"]),ref:$,onFocus:le,onBlur:ae},h.createElement("div",{id:H,className:D(S&&a["stretch-trigger-height"]),ref:g},l),h.createElement(U,{focusNextCallback:()=>{var e;return E.current&&((e=F(E.current))===null||e===void 0?void 0:e.focus())},disabled:!n||!v}),h.createElement(xe,{triggerRef:g,renderWithPortal:o&&!_,id:f,referrerId:H,open:n},h.createElement(he,{in:n??!1,exit:!1},(e,b)=>h.createElement("div",{ref:P},h.createElement(U,{focusNextCallback:()=>{var s;return g.current&&((s=Ee(g.current))===null||s===void 0?void 0:s.focus())},disabled:!n||!v}),h.createElement(ye,{state:e,transitionRef:b,dropdownClasses:ie,open:n,stretchWidth:i,interior:_,header:d,expandToViewport:o,stretchBeyondTriggerWidth:k,footer:u,onMouseDown:r,isRefresh:re,dropdownRef:E,verticalContainerRef:x,position:oe,id:T,role:ee,ariaLabelledby:te,ariaDescribedby:ne},t),h.createElement(U,{focusNextCallback:()=>{var s;return g.current&&((s=F(g.current))===null||s===void 0?void 0:s.focus())},disabled:!n||!v})))))},Me=t=>t.insetBlockEnd!==void 0,Qe=ze;export{Qe as D,Ke as u};
