var O=(s,t,r)=>{if(!t.has(s))throw TypeError("Cannot "+r)};var e=(s,t,r)=>(O(s,t,"read from private field"),r?r.call(s):t.get(s)),a=(s,t,r)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,r)},n=(s,t,r,i)=>(O(s,t,"write to private field"),i?i.call(s,r):t.set(s,r),r);function L(s,t=200){let r;return function(...i){r&&clearTimeout(r),r=setTimeout(()=>{r=null,s(...i)},t)}}function S(s){return s.slice().sort((t,r)=>r.orderPriority!==t.orderPriority?Math.sign((r.orderPriority??0)-(t.orderPriority??0)):r.id<t.id?1:-1)}class T{constructor(){this.listeners=[],this.actions=[],this.scheduleUpdate=L(()=>{this.listeners.forEach(t=>t(this.actions))},0),this.registerAction=t=>{this.actions.push(t),this.actions=S(this.actions),this.scheduleUpdate()},this.clearRegisteredActions=()=>{this.actions=[]},this.onActionRegistered=t=>(this.listeners.push(t),this.scheduleUpdate(),()=>{this.listeners=this.listeners.filter(r=>r!==t)})}installPublic(t={}){return t.registerAction??(t.registerAction=this.registerAction),t}installInternal(t={}){return t.clearRegisteredActions??(t.clearRegisteredActions=this.clearRegisteredActions),t.onActionRegistered??(t.onActionRegistered=this.onActionRegistered),t}}var w,f,h,m;class v{constructor(){a(this,w,void 0);a(this,f,void 0);a(this,h,void 0);a(this,m,void 0);n(this,w,[]),n(this,f,new Map),n(this,m,L(()=>e(this,w).forEach(t=>{if(e(this,h)){const r=t(e(this,h));e(this,f).set(t,r)}}),0)),this.registerContentReplacer=t=>{if(e(this,h)){console.warn(`Cannot call \`registerContentReplacer\` with new provider: provider with id "${e(this,h).id}" already registered.`);return}n(this,h,t),e(this,m).call(this)},this.clearRegisteredReplacer=()=>{n(this,h,void 0)},this.initialCheck=t=>{var r;return(r=e(this,h))!=null&&r.initialCheck?e(this,h).initialCheck(t):!1},this.onContentRegistered=t=>{if(e(this,h)){const r=t(e(this,h));e(this,w).push(t),e(this,f).set(t,r)}else e(this,w).push(t);return()=>{var r;(r=e(this,f).get(t))==null||r(),n(this,w,e(this,w).filter(i=>i!==t)),e(this,f).delete(t)}}}installPublic(t={}){return t.registerContentReplacer??(t.registerContentReplacer=this.registerContentReplacer),t}installInternal(t={}){return t.clearRegisteredReplacer??(t.clearRegisteredReplacer=this.clearRegisteredReplacer),t.onContentRegistered??(t.onContentRegistered=this.onContentRegistered),t.initialCheck??(t.initialCheck=this.initialCheck),t}}w=new WeakMap,f=new WeakMap,h=new WeakMap,m=new WeakMap;var u,U,b,D;class B{constructor(){a(this,u,void 0);a(this,U,void 0);a(this,b,void 0);a(this,D,void 0);n(this,u,[]),n(this,U,()=>{const t=e(this,u).find(r=>r.forceType==="primary");if(t)return t;for(const r of e(this,u).slice())if(r.forceType!=="secondary")return r}),n(this,b,()=>{const t=e(this,U).call(this),r=e(this,u).filter(i=>i!==t).map(i=>i.props);for(const i of e(this,u))i===t?i.onChange({type:"primary",discoveredProps:r}):i.onChange(i.secondaryInstance)}),n(this,D,L(()=>e(this,b).call(this),0)),this.register=(t,r)=>{const i=e(this,u).some(d=>d.forceType==="primary");if(t==="primary"&&i)throw new Error("Double primary registration attempt");const o={forceType:t,onChange:r,props:{},secondaryInstance:{type:"secondary",update:d=>{o.props=d,e(this,D).call(this)}}};return e(this,u).push(o),e(this,b).call(this),()=>{e(this,u).splice(e(this,u).indexOf(o),1),e(this,D).call(this)}},this.getStateForTesting=()=>({registrations:e(this,u)}),this.installInternal=(t={})=>(t.register??(t.register=this.register),t.getStateForTesting??(t.getStateForTesting=this.getStateForTesting),t)}}u=new WeakMap,U=new WeakMap,b=new WeakMap,D=new WeakMap;var l,c,g,y,P;class M{constructor(){a(this,l,void 0);a(this,c,void 0);a(this,g,void 0);a(this,y,void 0);a(this,P,void 0);n(this,l,null),n(this,c,[]),n(this,g,[]),n(this,y,L(()=>{if(!e(this,l))return;const t=e(this,c)[e(this,c).length-1];e(this,l).call(this,(t==null?void 0:t.props)??null)},0)),n(this,P,L(()=>{e(this,g).forEach(t=>t(!!e(this,l)))},0)),this.registerAppLayout=t=>{if(!e(this,l))return n(this,l,t),e(this,P).call(this),()=>{n(this,l,null),e(this,P).call(this)}},this.registerBreadcrumbs=(t,r)=>{const i={props:t};return e(this,c).push(i),e(this,g).push(r),e(this,P).call(this),e(this,y).call(this),{update:o=>{i.props=o,e(this,y).call(this)},cleanup:()=>{e(this,c).splice(e(this,c).indexOf(i),1),e(this,g).splice(e(this,g).indexOf(r),1),e(this,y).call(this)}}},this.getStateForTesting=()=>({appLayoutUpdateCallback:e(this,l),breadcrumbInstances:e(this,c),breadcrumbRegistrations:e(this,g)})}installInternal(t={}){return t.registerBreadcrumbs??(t.registerBreadcrumbs=this.registerBreadcrumbs),t.registerAppLayout??(t.registerAppLayout=this.registerAppLayout),t.getStateForTesting??(t.getStateForTesting=this.getStateForTesting),t}}l=new WeakMap,c=new WeakMap,g=new WeakMap,y=new WeakMap,P=new WeakMap;const _=["badge","resizable","defaultSize","orderPriority","defaultActive","onResize"];class z{constructor(){this.drawers=[],this.drawersRegistrationListener=null,this.drawerOpenedListener=null,this.drawerClosedListener=null,this.scheduleUpdate=L(()=>{var t;(t=this.drawersRegistrationListener)==null||t.call(this,this.drawers)},0),this.registerDrawer=t=>{this.drawers=this.drawers.concat(t),this.scheduleUpdate()},this.updateDrawer=({id:t,...r})=>{var x;const i=this.drawers.findIndex(({id:C})=>C===t),o=(x=this.drawers)==null?void 0:x[i];if(!o)throw new Error(`[AwsUi] [runtime drawers] drawer with id ${t} not found`);const d=this.drawers.slice(),R={...o};for(const C of _)C in r&&(R[C]=r[C]);d[i]=R,this.drawers=d,this.scheduleUpdate()},this.onDrawersRegistered=t=>(this.drawersRegistrationListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawersRegistrationListener=t,this.scheduleUpdate(),()=>{this.drawersRegistrationListener=null}),this.clearRegisteredDrawers=()=>{this.drawers=[]},this.onDrawerOpened=t=>(this.drawerOpenedListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawerOpenedListener=t,()=>{this.drawerOpenedListener=null}),this.onDrawerClosed=t=>(this.drawerClosedListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawerClosedListener=t,()=>{this.drawerClosedListener=null}),this.openDrawer=(t,r)=>{var i;(i=this.drawerOpenedListener)==null||i.call(this,t,r)},this.closeDrawer=(t,r)=>{var i;(i=this.drawerClosedListener)==null||i.call(this,t,r)}}installPublic(t={}){return t.registerDrawer??(t.registerDrawer=this.registerDrawer),t.updateDrawer??(t.updateDrawer=this.updateDrawer),t.openDrawer??(t.openDrawer=this.openDrawer),t.closeDrawer??(t.closeDrawer=this.closeDrawer),t}installInternal(t={}){return t.clearRegisteredDrawers??(t.clearRegisteredDrawers=this.clearRegisteredDrawers),t.onDrawersRegistered??(t.onDrawersRegistered=this.onDrawersRegistered),t.onDrawerOpened??(t.onDrawerOpened=this.onDrawerOpened),t.onDrawerClosed??(t.onDrawerClosed=this.onDrawerClosed),t}}var I;class Y{constructor(){a(this,I,void 0);n(this,I,new WeakMap),this.createContext=(t,r)=>{let i=e(this,I).get(t);i||(i=new Map,e(this,I).set(t,i));let o=i.get(r);return o||(o=t.createContext(void 0),i.set(r,o)),o}}installInternal(t={}){return t.createContext??(t.createContext=this.createContext),t}}I=new WeakMap;const E=Symbol.for("awsui-plugin-api");function k(s){try{return s!=null&&s[E]?s[E]:!s||s.parent===s?void 0:k(s.parent)}catch{return}}function $(){if(typeof window>"u")return F({});const s=window,t=k(s);return s[E]=F(t??{}),s[E]}const{awsuiPlugins:N,awsuiPluginsInternal:j}=$();function F(s){s.awsuiPlugins??(s.awsuiPlugins={}),s.awsuiPluginsInternal??(s.awsuiPluginsInternal={});const t=new z;s.awsuiPlugins.appLayout=t.installPublic(s.awsuiPlugins.appLayout),s.awsuiPluginsInternal.appLayout=t.installInternal(s.awsuiPluginsInternal.appLayout);const r=new B;s.awsuiPluginsInternal.appLayoutWidget=r.installInternal(s.awsuiPluginsInternal.appLayoutWidget);const i=new T;s.awsuiPlugins.alert=i.installPublic(s.awsuiPlugins.alert),s.awsuiPluginsInternal.alert=i.installInternal(s.awsuiPluginsInternal.alert);const o=new v;s.awsuiPlugins.alertContent=o.installPublic(s.awsuiPlugins.alertContent),s.awsuiPluginsInternal.alertContent=o.installInternal(s.awsuiPluginsInternal.alertContent);const d=new v;s.awsuiPlugins.flashContent=d.installPublic(s.awsuiPlugins.flashContent),s.awsuiPluginsInternal.flashContent=d.installInternal(s.awsuiPluginsInternal.flashContent);const R=new T;s.awsuiPlugins.flashbar=R.installPublic(s.awsuiPlugins.flashbar),s.awsuiPluginsInternal.flashbar=R.installInternal(s.awsuiPluginsInternal.flashbar);const x=new M;s.awsuiPluginsInternal.breadcrumbs=x.installInternal(s.awsuiPluginsInternal.breadcrumbs);const C=new Y;return s.awsuiPluginsInternal.sharedReactContexts=C.installInternal(s.awsuiPluginsInternal.sharedReactContexts),s}export{N as a};
