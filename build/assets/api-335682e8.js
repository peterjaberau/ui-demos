import{d as g}from"./debounce-acf18bef.js";import{h as r,j as y,_ as W}from"./index-eb73e870.js";function B(i){return i.slice().sort((e,t)=>{var s,n;return t.orderPriority!==e.orderPriority?Math.sign(((s=t.orderPriority)!==null&&s!==void 0?s:0)-((n=e.orderPriority)!==null&&n!==void 0?n:0)):t.id<e.id?1:-1})}class k{constructor(){this.listeners=[],this.actions=[],this.scheduleUpdate=g(()=>{this.listeners.forEach(e=>e(this.actions))},0),this.registerAction=e=>{this.actions.push(e),this.actions=B(this.actions),this.scheduleUpdate()},this.clearRegisteredActions=()=>{this.actions=[]},this.onActionRegistered=e=>(this.listeners.push(e),this.scheduleUpdate(),()=>{this.listeners=this.listeners.filter(t=>t!==e)})}installPublic(e={}){var t;return(t=e.registerAction)!==null&&t!==void 0||(e.registerAction=this.registerAction),e}installInternal(e={}){var t,s;return(t=e.clearRegisteredActions)!==null&&t!==void 0||(e.clearRegisteredActions=this.clearRegisteredActions),(s=e.onActionRegistered)!==null&&s!==void 0||(e.onActionRegistered=this.onActionRegistered),e}}var c,f,l,D;class x{constructor(){c.set(this,[]),f.set(this,new Map),l.set(this,void 0),D.set(this,g(()=>r(this,c,"f").forEach(e=>{if(r(this,l,"f")){const t=e(r(this,l,"f"));r(this,f,"f").set(e,t)}}),0)),this.registerContentReplacer=e=>{if(r(this,l,"f")){console.warn(`Cannot call \`registerContentReplacer\` with new provider: provider with id "${r(this,l,"f").id}" already registered.`);return}y(this,l,e,"f"),r(this,D,"f").call(this)},this.clearRegisteredReplacer=()=>{y(this,l,void 0,"f")},this.initialCheck=e=>{var t;return!((t=r(this,l,"f"))===null||t===void 0)&&t.initialCheck?r(this,l,"f").initialCheck(e):!1},this.onContentRegistered=e=>{if(r(this,l,"f")){const t=e(r(this,l,"f"));r(this,c,"f").push(e),r(this,f,"f").set(e,t)}else r(this,c,"f").push(e);return()=>{var t;(t=r(this,f,"f").get(e))===null||t===void 0||t(),y(this,c,r(this,c,"f").filter(s=>s!==e),"f"),r(this,f,"f").delete(e)}}}installPublic(e={}){var t;return(t=e.registerContentReplacer)!==null&&t!==void 0||(e.registerContentReplacer=this.registerContentReplacer),e}installInternal(e={}){var t,s,n;return(t=e.clearRegisteredReplacer)!==null&&t!==void 0||(e.clearRegisteredReplacer=this.clearRegisteredReplacer),(s=e.onContentRegistered)!==null&&s!==void 0||(e.onContentRegistered=this.onContentRegistered),(n=e.initialCheck)!==null&&n!==void 0||(e.initialCheck=this.initialCheck),e}}c=new WeakMap,f=new WeakMap,l=new WeakMap,D=new WeakMap;var o,L,P,R;class O{constructor(){o.set(this,[]),L.set(this,()=>{const e=r(this,o,"f").find(t=>t.forceType==="primary");if(e)return e;for(const t of r(this,o,"f").slice())if(t.forceType!=="secondary")return t}),P.set(this,()=>{const e=r(this,L,"f").call(this),t=r(this,o,"f").filter(s=>s!==e).map(s=>s.props);for(const s of r(this,o,"f"))s===e?s.onChange({type:"primary",discoveredProps:t}):s.onChange(s.secondaryInstance)}),R.set(this,g(()=>r(this,P,"f").call(this),0)),this.register=(e,t)=>{const s=r(this,o,"f").some(a=>a.forceType==="primary");if(e==="primary"&&s)throw new Error("Double primary registration attempt");const n={forceType:e,onChange:t,props:{},secondaryInstance:{type:"secondary",update:a=>{n.props=a,r(this,R,"f").call(this)}}};return r(this,o,"f").push(n),r(this,P,"f").call(this),()=>{r(this,o,"f").splice(r(this,o,"f").indexOf(n),1),r(this,R,"f").call(this)}},this.getStateForTesting=()=>({registrations:r(this,o,"f")}),this.installInternal=(e={})=>{var t,s;return(t=e.register)!==null&&t!==void 0||(e.register=this.register),(s=e.getStateForTesting)!==null&&s!==void 0||(e.getStateForTesting=this.getStateForTesting),e}}}o=new WeakMap,L=new WeakMap,P=new WeakMap,R=new WeakMap;var u,d,w,_,b;class S{constructor(){u.set(this,null),d.set(this,[]),w.set(this,[]),_.set(this,g(()=>{var e;if(!r(this,u,"f"))return;const t=r(this,d,"f")[r(this,d,"f").length-1];r(this,u,"f").call(this,(e=t==null?void 0:t.props)!==null&&e!==void 0?e:null)},0)),b.set(this,g(()=>{r(this,w,"f").forEach(e=>e(!!r(this,u,"f")))},0)),this.registerAppLayout=e=>{if(!r(this,u,"f"))return y(this,u,e,"f"),r(this,b,"f").call(this),()=>{y(this,u,null,"f"),r(this,b,"f").call(this)}},this.registerBreadcrumbs=(e,t)=>{const s={props:e};return r(this,d,"f").push(s),r(this,w,"f").push(t),r(this,b,"f").call(this),r(this,_,"f").call(this),{update:n=>{s.props=n,r(this,_,"f").call(this)},cleanup:()=>{r(this,d,"f").splice(r(this,d,"f").indexOf(s),1),r(this,w,"f").splice(r(this,w,"f").indexOf(t),1),r(this,_,"f").call(this)}}},this.getStateForTesting=()=>({appLayoutUpdateCallback:r(this,u,"f"),breadcrumbInstances:r(this,d,"f"),breadcrumbRegistrations:r(this,w,"f")})}installInternal(e={}){var t,s,n;return(t=e.registerBreadcrumbs)!==null&&t!==void 0||(e.registerBreadcrumbs=this.registerBreadcrumbs),(s=e.registerAppLayout)!==null&&s!==void 0||(e.registerAppLayout=this.registerAppLayout),(n=e.getStateForTesting)!==null&&n!==void 0||(e.getStateForTesting=this.getStateForTesting),e}}u=new WeakMap,d=new WeakMap,w=new WeakMap,_=new WeakMap,b=new WeakMap;const T=["badge","resizable","defaultSize","orderPriority","defaultActive","onResize"];class A{constructor(){this.drawers=[],this.drawersRegistrationListener=null,this.drawerOpenedListener=null,this.drawerClosedListener=null,this.scheduleUpdate=g(()=>{var e;(e=this.drawersRegistrationListener)===null||e===void 0||e.call(this,this.drawers)},0),this.registerDrawer=e=>{this.drawers=this.drawers.concat(e),this.scheduleUpdate()},this.updateDrawer=e=>{var t,{id:s}=e,n=W(e,["id"]);const a=this.drawers.findIndex(({id:h})=>h===s),p=(t=this.drawers)===null||t===void 0?void 0:t[a];if(!p)throw new Error(`[AwsUi] [runtime drawers] drawer with id ${s} not found`);const C=this.drawers.slice(),v=Object.assign({},p);for(const h of T)h in n&&(v[h]=n[h]);C[a]=v,this.drawers=C,this.scheduleUpdate()},this.onDrawersRegistered=e=>(this.drawersRegistrationListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawersRegistrationListener=e,this.scheduleUpdate(),()=>{this.drawersRegistrationListener=null}),this.clearRegisteredDrawers=()=>{this.drawers=[]},this.onDrawerOpened=e=>(this.drawerOpenedListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawerOpenedListener=e,()=>{this.drawerOpenedListener=null}),this.onDrawerClosed=e=>(this.drawerClosedListener!==null&&console.warn("[AwsUi] [runtime drawers] multiple app layout instances detected"),this.drawerClosedListener=e,()=>{this.drawerClosedListener=null}),this.openDrawer=(e,t)=>{var s;(s=this.drawerOpenedListener)===null||s===void 0||s.call(this,e,t)},this.closeDrawer=(e,t)=>{var s;(s=this.drawerClosedListener)===null||s===void 0||s.call(this,e,t)}}installPublic(e={}){var t,s,n,a;return(t=e.registerDrawer)!==null&&t!==void 0||(e.registerDrawer=this.registerDrawer),(s=e.updateDrawer)!==null&&s!==void 0||(e.updateDrawer=this.updateDrawer),(n=e.openDrawer)!==null&&n!==void 0||(e.openDrawer=this.openDrawer),(a=e.closeDrawer)!==null&&a!==void 0||(e.closeDrawer=this.closeDrawer),e}installInternal(e={}){var t,s,n,a;return(t=e.clearRegisteredDrawers)!==null&&t!==void 0||(e.clearRegisteredDrawers=this.clearRegisteredDrawers),(s=e.onDrawersRegistered)!==null&&s!==void 0||(e.onDrawersRegistered=this.onDrawersRegistered),(n=e.onDrawerOpened)!==null&&n!==void 0||(e.onDrawerOpened=this.onDrawerOpened),(a=e.onDrawerClosed)!==null&&a!==void 0||(e.onDrawerClosed=this.onDrawerClosed),e}}var m;class E{constructor(){m.set(this,new WeakMap),this.createContext=(e,t)=>{let s=r(this,m,"f").get(e);s||(s=new Map,r(this,m,"f").set(e,s));let n=s.get(t);return n||(n=e.createContext(void 0),s.set(t,n)),n}}installInternal(e={}){var t;return(t=e.createContext)!==null&&t!==void 0||(e.createContext=this.createContext),e}}m=new WeakMap;const I=Symbol.for("awsui-plugin-api");function F(i){try{return i!=null&&i[I]?i[I]:!i||i.parent===i?void 0:F(i.parent)}catch{return}}function z(){if(typeof window>"u")return M({});const i=window,e=F(i);return i[I]=M(e??{}),i[I]}const{awsuiPlugins:G,awsuiPluginsInternal:K}=z();function M(i){var e,t;(e=i.awsuiPlugins)!==null&&e!==void 0||(i.awsuiPlugins={}),(t=i.awsuiPluginsInternal)!==null&&t!==void 0||(i.awsuiPluginsInternal={});const s=new A;i.awsuiPlugins.appLayout=s.installPublic(i.awsuiPlugins.appLayout),i.awsuiPluginsInternal.appLayout=s.installInternal(i.awsuiPluginsInternal.appLayout);const n=new O;i.awsuiPluginsInternal.appLayoutWidget=n.installInternal(i.awsuiPluginsInternal.appLayoutWidget);const a=new k;i.awsuiPlugins.alert=a.installPublic(i.awsuiPlugins.alert),i.awsuiPluginsInternal.alert=a.installInternal(i.awsuiPluginsInternal.alert);const p=new x;i.awsuiPlugins.alertContent=p.installPublic(i.awsuiPlugins.alertContent),i.awsuiPluginsInternal.alertContent=p.installInternal(i.awsuiPluginsInternal.alertContent);const C=new x;i.awsuiPlugins.flashContent=C.installPublic(i.awsuiPlugins.flashContent),i.awsuiPluginsInternal.flashContent=C.installInternal(i.awsuiPluginsInternal.flashContent);const v=new k;i.awsuiPlugins.flashbar=v.installPublic(i.awsuiPlugins.flashbar),i.awsuiPluginsInternal.flashbar=v.installInternal(i.awsuiPluginsInternal.flashbar);const h=new S;i.awsuiPluginsInternal.breadcrumbs=h.installInternal(i.awsuiPluginsInternal.breadcrumbs);const U=new E;return i.awsuiPluginsInternal.sharedReactContexts=U.installInternal(i.awsuiPluginsInternal.sharedReactContexts),i}export{K as a,B as s};
