import{_ as ke,c as L,e as At,b as Ct,d as It}from"./index-eb73e870.js";import{R as n,r as z}from"./index-2c36b58a.js";import"./ResizeObserver-6fd345a6.js";import{c as bt,g as ve}from"./attributes-9cbf7bc1.js";import{c as Ie,I as Pt}from"./internal-1d1af924.js";import{u as Qe,t as it,T as Ft}from"./dismiss-button-daa4f835.js";import{b as me,f as Ce}from"./index-491afaa4.js";import{u as Ue}from"./index-33af1cce.js";import{u as Z}from"./index-5c04613c.js";import{I as St}from"./internal-90218b53.js";import{u as Nt,S as Rt}from"./use-debounce-search-result-callback-08476abb.js";import{u as jt}from"./context-d1fbdd85.js";import{I as Dt}from"./internal-76dde1ac.js";import{u as qt,F as _t}from"./form-field-context-fcff921e.js";import{D as $e,u as Vt}from"./use-highlight-option-7a4dfde2.js";import{S as zt}from"./index-d8010092.js";import{V as Mt,P as Gt}from"./use-select-0ff13a42.js";import{u as Kt,s as $t,I as Ht}from"./internal-8df4efef.js";import{u as Bt,a as Wt,A as Qt,b as Ut,c as Jt,I as Xt}from"./internal-6057655b.js";import{g as Yt}from"./utils-06561385.js";import{j as kt}from"./join-strings-170e7968.js";import{u as Zt}from"./index-47bb06f7.js";import{I as ft}from"./internal-67a4bdad.js";import{I as lt}from"./internal-337363c2.js";import{I as Je}from"./internal-9b1189e6.js";import{I as He}from"./internal-605c76be.js";import{I as st}from"./internal-4ec290ce.js";import{u as eo}from"./index-1b07c59a.js";function to(e,o){let t=0,l=null;for(const i of e)(i.propertyLabel.length>=t&&Pe(o,i.propertyLabel)||i.propertyLabel.length>t&&Pe(o.toLowerCase(),i.propertyLabel.toLowerCase()))&&(t=i.propertyLabel.length,l=i);return l}function ut(e,o){o=o.toLowerCase();let t=0,l=null;for(const i of e)i.length>t&&Pe(o,i.toLowerCase())&&(t=i.length,l=i);return l}function oo(e,o){if(o.trim().length===0)return"";for(const t of e)if(Pe(t.toLowerCase(),o.toLowerCase()))return o;return null}function ro({property:e,operator:o,value:t},l){var i,u;const d=e==null?void 0:e.getTokenType(o),c=l.filter(a=>a.property===e),r=a=>a===null?d==="enum"?[]:null:d==="enum"&&!Array.isArray(a)?[a]:a,s={propertyKey:e==null?void 0:e.propertyKey,operator:o,value:r(t)};for(const a of c){if(a.label&&a.label===t||!a.label&&a.value===t)return{propertyKey:e==null?void 0:e.propertyKey,operator:o,value:r(a.value)};typeof t=="string"&&t.toLowerCase()===((u=(i=a.label)!==null&&i!==void 0?i:a.value)!==null&&u!==void 0?u:"").toLowerCase()&&(s.value=r(a.value))}return s}function ct(e){let o=0;for(let t=0;t<e.length&&e[t]===" ";t++)o++;return e.slice(o)}function no(e){return e[0]===" "?e.slice(1):e}function pt(e,o){const t=e.indexOf(o)+o.length,l=e.slice(t);return no(l)}function Pe(e,o){return e.indexOf(o)===0}function Le(e){const o=[];for(const t of e)if("operator"in t)o.push(t);else for(const l of t.tokens)"operator"in l&&o.push(l);return o}function ao(e={}){var o;const t=jt("property-filter"),l=t("i18nStrings.allPropertiesLabel",e==null?void 0:e.allPropertiesLabel),i=t("i18nStrings.operationAndText",e==null?void 0:e.operationAndText),u=t("i18nStrings.operationOrText",e==null?void 0:e.operationOrText),d=(o=t("i18nStrings.formatToken",e.formatToken,r=>s=>r({token__propertyLabel:s.propertyLabel,token__operator:io(s.operator),token__value:s.value})))!==null&&o!==void 0?o:r=>`${r.propertyLabel} ${r.operator} ${r.value}`;function c(r){var s,a,p;let m=(s=r.property)===null||s===void 0?void 0:s.getValueFormatter(r.operator);!m&&((a=r.property)===null||a===void 0?void 0:a.getTokenType(r.operator))==="enum"&&(m=k=>Array.isArray(k)?k.join(", "):k);const v=r.property?r.property.propertyLabel:l??"",_=m?m(r.value):r.value;return{propertyKey:(p=r.property)===null||p===void 0?void 0:p.propertyKey,propertyLabel:v,operator:r.operator,value:_}}return Object.assign(Object.assign({},e),{allPropertiesLabel:l,operationAndText:i,operationOrText:u,applyActionText:t("i18nStrings.applyActionText",e==null?void 0:e.applyActionText),cancelActionText:t("i18nStrings.cancelActionText",e==null?void 0:e.cancelActionText),clearFiltersText:t("i18nStrings.clearFiltersText",e==null?void 0:e.clearFiltersText),editTokenHeader:t("i18nStrings.editTokenHeader",e==null?void 0:e.editTokenHeader),groupPropertiesText:t("i18nStrings.groupPropertiesText",e==null?void 0:e.groupPropertiesText),groupValuesText:t("i18nStrings.groupValuesText",e==null?void 0:e.groupValuesText),operatorContainsText:t("i18nStrings.operatorContainsText",e==null?void 0:e.operatorContainsText),operatorDoesNotContainText:t("i18nStrings.operatorDoesNotContainText",e==null?void 0:e.operatorDoesNotContainText),operatorDoesNotEqualText:t("i18nStrings.operatorDoesNotEqualText",e==null?void 0:e.operatorDoesNotEqualText),operatorEqualsText:t("i18nStrings.operatorEqualsText",e==null?void 0:e.operatorEqualsText),operatorGreaterOrEqualText:t("i18nStrings.operatorGreaterOrEqualText",e==null?void 0:e.operatorGreaterOrEqualText),operatorGreaterText:t("i18nStrings.operatorGreaterText",e==null?void 0:e.operatorGreaterText),operatorLessOrEqualText:t("i18nStrings.operatorLessOrEqualText",e==null?void 0:e.operatorLessOrEqualText),operatorLessText:t("i18nStrings.operatorLessText",e==null?void 0:e.operatorLessText),operatorStartsWithText:t("i18nStrings.operatorStartsWithText",e==null?void 0:e.operatorStartsWithText),operatorDoesNotStartWithText:t("i18nStrings.operatorDoesNotStartWithText",e==null?void 0:e.operatorDoesNotStartWithText),operatorText:t("i18nStrings.operatorText",e==null?void 0:e.operatorText),operatorsText:t("i18nStrings.operatorsText",e==null?void 0:e.operatorsText),propertyText:t("i18nStrings.propertyText",e==null?void 0:e.propertyText),tokenLimitShowFewer:t("i18nStrings.tokenLimitShowFewer",e==null?void 0:e.tokenLimitShowFewer),tokenLimitShowMore:t("i18nStrings.tokenLimitShowMore",e==null?void 0:e.tokenLimitShowMore),valueText:t("i18nStrings.valueText",e==null?void 0:e.valueText),tokenEditorTokenRemoveLabel:t("i18nStrings.tokenEditorTokenRemoveLabel",e==null?void 0:e.tokenEditorTokenRemoveLabel),tokenEditorTokenRemoveFromGroupLabel:t("i18nStrings.tokenEditorTokenRemoveFromGroupLabel",e==null?void 0:e.tokenEditorTokenRemoveFromGroupLabel),tokenEditorAddNewTokenLabel:t("i18nStrings.tokenEditorAddNewTokenLabel",e==null?void 0:e.tokenEditorAddNewTokenLabel),tokenEditorAddTokenActionsAriaLabel:t("i18nStrings.tokenEditorAddTokenActionsAriaLabel",e==null?void 0:e.tokenEditorAddTokenActionsAriaLabel),formatToken:r=>{const s=c(r);return Object.assign(Object.assign({},s),{formattedText:d(c(r))})},groupAriaLabel:r=>{var s;const a=Le(r.tokens).map(c),p=(s=r.operation==="and"?i:u)!==null&&s!==void 0?s:"";return a.map(m=>d(m)).join(` ${p} `)},groupEditAriaLabel:r=>{var s,a;const p=Le(r.tokens).map(k=>c(k)),m=r.operation,v=(s=m==="and"?i:u)!==null&&s!==void 0?s:"",_=t("i18nStrings.groupEditAriaLabel",e.groupEditAriaLabel,k=>()=>k({group__operationLabel:v,group__formattedTokens__length:p.length.toString(),group__formattedTokens0__formattedText:p[0]?d(p[0]):"",group__formattedTokens1__formattedText:p[1]?d(p[1]):"",group__formattedTokens2__formattedText:p[2]?d(p[2]):"",group__formattedTokens3__formattedText:p[3]?d(p[3]):""}));return(a=_==null?void 0:_({operation:m,operationLabel:v,tokens:p}))!==null&&a!==void 0?a:""},removeTokenButtonAriaLabel:r=>{var s;const a=t("i18nStrings.removeTokenButtonAriaLabel",e.removeTokenButtonAriaLabel,p=>()=>p({token__formattedText:d(c(r))}));return(s=a==null?void 0:a(c(r)))!==null&&s!==void 0?s:""},tokenEditorTokenActionsAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorTokenActionsAriaLabel",e.tokenEditorTokenActionsAriaLabel,p=>()=>p({token__formattedText:d(c(r))}));return(s=a==null?void 0:a(c(r)))!==null&&s!==void 0?s:""},tokenEditorTokenRemoveAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorTokenRemoveAriaLabel",e.tokenEditorTokenRemoveAriaLabel,p=>()=>p({token__formattedText:d(c(r))}));return(s=a==null?void 0:a(c(r)))!==null&&s!==void 0?s:""},tokenEditorAddExistingTokenAriaLabel:r=>{var s;const a=t("i18nStrings.tokenEditorAddExistingTokenAriaLabel",e.tokenEditorAddExistingTokenAriaLabel,p=>()=>p({token__formattedText:d(c(r))}));return(s=a==null?void 0:a(c(r)))!==null&&s!==void 0?s:""},tokenEditorAddExistingTokenLabel:r=>{var s;const a=c(r),p=t("i18nStrings.tokenEditorAddExistingTokenLabel",e.tokenEditorAddExistingTokenLabel,m=>()=>m({token__propertyLabel:a.propertyLabel,token__operator:a.operator,token__value:a.value}));return(s=p==null?void 0:p(c(r)))!==null&&s!==void 0?s:""}})}function Be(e,o){switch(e){case"<":return o.operatorLessText;case"<=":return o.operatorLessOrEqualText;case">":return o.operatorGreaterText;case">=":return o.operatorGreaterOrEqualText;case":":return o.operatorContainsText;case"!:":return o.operatorDoesNotContainText;case"=":return o.operatorEqualsText;case"!=":return o.operatorDoesNotEqualText;case"^":return o.operatorStartsWithText;case"!^":return o.operatorDoesNotStartWithText;default:return""}}function io(e){switch(e){case"=":return"equals";case"!=":return"not_equals";case">":return"greater_than";case">=":return"greater_than_equal";case"<":return"less_than";case"<=":return"less_than_equal";case":":return"contains";case"!:":return"not_contains";case"^":return"starts_with";case"!^":return"not_starts_with";default:return e}}const lo=({query:e,onChange:o,filteringOptions:t,enableTokenGroups:l})=>{const i=a=>{function p(v){return"operator"in v?ro(v,t):Object.assign(Object.assign({},v),{tokens:v.tokens.map(p)})}const m=a.tokens.map(p);l?me(o,{tokens:[],operation:a.operation,tokenGroups:m}):me(o,{tokens:Le(m),operation:a.operation})};return{addToken:a=>{i(Object.assign(Object.assign({},e),{tokens:[...e.tokens,a]}))},updateToken:(a,p,m)=>{const _=Le([p]).map(T=>T.standaloneIndex).filter(T=>T!==void 0),k=e.tokens.map((T,h)=>h===a?p:T).filter((T,h)=>h===a||!_.includes(h));k.push(...m),i(Object.assign(Object.assign({},e),{tokens:k}))},updateOperation:a=>{i(Object.assign(Object.assign({},e),{operation:a}))},removeToken:a=>{i(Object.assign(Object.assign({},e),{tokens:e.tokens.filter((p,m)=>m!==a)}))},removeAllTokens:()=>{i(Object.assign(Object.assign({},e),{tokens:[]}))}}},fe=e=>{const{operators:o=[],defaultOperator:t}=e,l=["=","!=",":","!:","^","!^",">=","<=","<",">"],i=new Set([t,...o]);return l.filter(u=>i.has(u))},Ge=(e,o,t)=>{const l=to(o,e);if(!l){if(!t.disabled){const r=t.operators.indexOf("!:")>=0?["!",...t.operators]:t.operators,s=ut(r,e);if(s)return{step:"free-text",operator:s==="!"?"!:":s,value:pt(e,s)}}return{step:"free-text",value:e}}const i=fe(l),u=e.substring(l.propertyLabel.length),d=ut(i,ct(u));if(d)return{step:"property",property:l,operator:d,value:pt(u,d)};const c=oo(i,ct(u));return c!==null?{step:"operator",property:l,operatorPrefix:c}:{step:"free-text",value:e}},so=(e,o="=",t,l)=>{var i;const u={label:(i=t.groupValuesText)!==null&&i!==void 0?i:"",options:[]},d={};return e.forEach(c=>{const r=c.property;if(!r||fe(r).indexOf(o)===-1)return;if(r.propertyGroup&&!d[r.propertyGroup]){const a=l.reduce((p,m)=>m.group===r.propertyGroup?m.values:p,"");d[r.propertyGroup]={label:a,options:[]}}(r.propertyGroup?d[r.propertyGroup]:u).options.push({value:r.propertyLabel+" "+(o||"=")+" "+c.value,label:c.label,__labelPrefix:r.propertyLabel+" "+(o||"=")})}),[u,...Object.keys(d).map(c=>d[c])]},dt=e=>({value:e.propertyLabel,label:e.propertyLabel,keepOpenOnSelect:!0});function We(e,o,t,l){var i;const u={label:(i=t.groupPropertiesText)!==null&&i!==void 0?i:"",options:[]},d={};e.forEach(s=>{const{propertyGroup:a}=s;let p=u;if(a){if(!d[a]){const m=o.reduce((v,_)=>_.group===a?_.properties:v,"");d[a]={options:[],label:m}}p=d[a]}p.options.push(l(s))});const c=u.options.length?[u]:[],r=Object.keys(d).map(s=>d[s]);return[...c,...r]}const uo=(e,o,t,l,i)=>{switch(e.step){case"property":{const{propertyLabel:u,groupValuesLabel:d}=e.property,c=t.filter(r=>r.property===e.property);return{filterText:e.value,options:[{options:c.map(({label:r,value:s})=>({value:u+" "+e.operator+" "+s,label:r,__labelPrefix:u+" "+e.operator})),label:d}]}}case"operator":return{filterText:e.property.propertyLabel+" "+e.operatorPrefix,options:[...We(o,l,i,dt),{options:fe(e.property).map(u=>({value:e.property.propertyLabel+" "+u+" ",label:e.property.propertyLabel+" "+u,description:Be(u,i),keepOpenOnSelect:!0})),label:i.operatorsText}]};case"free-text":{const u=!!e.value,d=!(e.step==="free-text"&&e.operator==="!:");return{filterText:e.value,options:[...d?We(o,l,i,dt):[],...u?so(t,e.operator,i,l):[]]}}}},co=n.forwardRef((e,o)=>{var{options:t,filteringType:l,ariaLabel:i,selectedOptions:u,deselectAriaLabel:d,virtualScroll:c,filteringText:r=""}=e,s=ke(e,["options","filteringType","ariaLabel","selectedOptions","deselectAriaLabel","virtualScroll","filteringText"]);const a=qt(s),p=Z("multiselect-ariaLabel-"),m=Z("multiselect-footer-"),v=Kt(Object.assign({options:t,selectedOptions:u,filteringType:l,disabled:!1,deselectAriaLabel:d,controlId:a.controlId,ariaLabelId:p,footerId:m,filteringValue:r,externalRef:o,keepOpen:!0,embedded:!0},s)),_=c?Mt:Gt,k=v.dropdownStatus;return n.createElement("div",{className:$t.embedded},n.createElement(_,{menuProps:v.getMenuProps(),getOptionProps:v.getOptionProps,filteredOptions:v.filteredOptions,filteringValue:r,ref:v.scrollToIndex,hasDropdownStatus:k.content!==null,checkboxes:!0,useInteractiveGroups:!0,screenReaderContent:v.announcement,highlightType:v.highlightType}),k.content&&n.createElement($e,{content:k.content,id:m}),n.createElement(zt,{id:p},i))}),po=co;function Xe(e,o=""){if(!o)return e;const t=[];for(const l of e)if(mo(l)){const i=Xe(l.options,o);i.length>0&&t.push(Object.assign(Object.assign({},l),{options:i}))}else vo(l,o)&&t.push(l);return t}function mo(e){return"options"in e}function vo(e,o){var t,l;o=o.toLowerCase();const i=((t=e.label)!==null&&t!==void 0?t:"").toLowerCase(),u=(l=e.__labelPrefix)!==null&&l!==void 0?l:"",d=(e.value?e.value.slice(u.length):"").toLowerCase();return i.indexOf(o)!==-1||d.indexOf(o)!==-1}const Oe=(e,o,t,l,i)=>{const u=z.useRef(!1),d=()=>{u.current=!0},c=a=>{var p;me(e,Object.assign(Object.assign({},a),{filteringText:(p=l??a.filteringText)!==null&&p!==void 0?p:"",filteringProperty:t,filteringOperator:i})),u.current=!1};return{onBlur:d,onFocus:()=>{u.current&&c({firstPage:!0,samePage:!1,filteringText:o})},onLoadItems:({detail:a})=>c(a)}};const b={root:"awsui_root_1wzqe_piuc8_145","search-field":"awsui_search-field_1wzqe_piuc8_177","input-wrapper":"awsui_input-wrapper_1wzqe_piuc8_184","add-token":"awsui_add-token_1wzqe_piuc8_191",tokens:"awsui_tokens_1wzqe_piuc8_198","token-operator":"awsui_token-operator_1wzqe_piuc8_203","property-editor":"awsui_property-editor_1wzqe_piuc8_207","property-editor-header":"awsui_property-editor-header_1wzqe_piuc8_210","property-editor-header-enum":"awsui_property-editor-header-enum_1wzqe_piuc8_223","property-editor-form":"awsui_property-editor-form_1wzqe_piuc8_238","property-editor-cancel":"awsui_property-editor-cancel_1wzqe_piuc8_243","property-editor-actions":"awsui_property-editor-actions_1wzqe_piuc8_246","property-editor-enum":"awsui_property-editor-enum_1wzqe_piuc8_254","token-editor":"awsui_token-editor_1wzqe_piuc8_259","token-editor-form":"awsui_token-editor-form_1wzqe_piuc8_266","token-editor-field-property":"awsui_token-editor-field-property_1wzqe_piuc8_269","token-editor-field-operator":"awsui_token-editor-field-operator_1wzqe_piuc8_272","token-editor-field-value":"awsui_token-editor-field-value_1wzqe_piuc8_275","token-editor-multiselect-wrapper":"awsui_token-editor-multiselect-wrapper_1wzqe_piuc8_278","token-editor-multiselect-wrapper-inner":"awsui_token-editor-multiselect-wrapper-inner_1wzqe_piuc8_283","token-editor-cancel":"awsui_token-editor-cancel_1wzqe_piuc8_287","token-editor-submit":"awsui_token-editor-submit_1wzqe_piuc8_290","token-editor-actions":"awsui_token-editor-actions_1wzqe_piuc8_293","token-editor-grid":"awsui_token-editor-grid_1wzqe_piuc8_302","token-editor-grid-group":"awsui_token-editor-grid-group_1wzqe_piuc8_336","token-editor-narrow":"awsui_token-editor-narrow_1wzqe_piuc8_339","token-editor-supports-groups":"awsui_token-editor-supports-groups_1wzqe_piuc8_348","token-editor-grid-header":"awsui_token-editor-grid-header_1wzqe_piuc8_352","token-editor-grid-cell":"awsui_token-editor-grid-cell_1wzqe_piuc8_358","token-editor-add-token":"awsui_token-editor-add-token_1wzqe_piuc8_367","custom-content-wrapper":"awsui_custom-content-wrapper_1wzqe_piuc8_371","custom-control":"awsui_custom-control_1wzqe_piuc8_375",input:"awsui_input_1wzqe_piuc8_184",results:"awsui_results_1wzqe_piuc8_383","token-trigger":"awsui_token-trigger_1wzqe_piuc8_388","remove-all":"awsui_remove-all_1wzqe_piuc8_393","join-operation":"awsui_join-operation_1wzqe_piuc8_394","custom-filter-actions":"awsui_custom-filter-actions_1wzqe_piuc8_395",constraint:"awsui_constraint_1wzqe_piuc8_399"};const M={"filtering-token":"awsui_filtering-token_1heb1_1ayd6_5","filtering-token-dismiss-button":"awsui_filtering-token-dismiss-button_1heb1_1ayd6_9","filtering-token-select":"awsui_filtering-token-select_1heb1_1ayd6_13","filtering-token-content":"awsui_filtering-token-content_1heb1_1ayd6_17","filtering-token-inner":"awsui_filtering-token-inner_1heb1_1ayd6_21","filtering-token-inner-dismiss-button":"awsui_filtering-token-inner-dismiss-button_1heb1_1ayd6_25","filtering-token-inner-select":"awsui_filtering-token-inner-select_1heb1_1ayd6_29","filtering-token-inner-content":"awsui_filtering-token-inner-content_1heb1_1ayd6_33","filtering-token-edit-button":"awsui_filtering-token-edit-button_1heb1_1ayd6_37","token-editor-field-property":"awsui_token-editor-field-property_1heb1_1ayd6_41","token-editor-field-operator":"awsui_token-editor-field-operator_1heb1_1ayd6_45","token-editor-field-value":"awsui_token-editor-field-value_1heb1_1ayd6_49","token-editor-token-remove-actions":"awsui_token-editor-token-remove-actions_1heb1_1ayd6_53","token-editor-token-add-actions":"awsui_token-editor-token-add-actions_1heb1_1ayd6_57","token-editor-cancel":"awsui_token-editor-cancel_1heb1_1ayd6_61","token-editor-submit":"awsui_token-editor-submit_1heb1_1ayd6_65","property-editor-cancel":"awsui_property-editor-cancel_1heb1_1ayd6_69","property-editor-submit":"awsui_property-editor-submit_1heb1_1ayd6_73"};function go({property:e,operator:o,filter:t,value:l,onChange:i,operatorForm:u}){const d=Z();return n.createElement("div",{className:b["property-editor"]},n.createElement("div",{className:b["property-editor-header"],id:d},e.groupValuesLabel),n.createElement("div",{className:b["property-editor-form"]},n.createElement(_t.Provider,{value:{ariaLabelledby:d}},u({value:l,onChange:i,operator:o,filter:t}))))}function bo({property:e,filter:o,value:t,onChange:l,asyncProps:i,filteringOptions:u,onLoadItems:d}){const c=u.filter(m=>{var v;return((v=m.property)===null||v===void 0?void 0:v.propertyKey)===e.propertyKey}).map(({label:m,value:v})=>({label:m,value:v})),r=Oe(d,"",e.externalProperty),s=t?Array.isArray(t)?t:[t]:[],a=c.filter(m=>s.includes(m.value)),p=Xe(c,o);return n.createElement("div",{className:L(b["property-editor"],b["property-editor-enum"])},p.length===0&&n.createElement("div",{className:b["property-editor-header-enum"]},n.createElement(Dt,{checked:!1,readOnly:!0}),e.groupValuesLabel),n.createElement(po,Object.assign({filteringType:"manual",selectedOptions:a,onChange:m=>l(m.detail.selectedOptions.map(v=>v.value)),options:p.length>0?[{options:p,label:e.groupValuesLabel}]:[],filteringText:o,ariaLabel:e.groupValuesLabel,statusType:"finished",noMatch:i.empty},r,i)))}function _o({property:e,operator:o,value:t,onCancel:l,onSubmit:i,i18nStrings:u}){const d=()=>i({property:e,operator:o,value:t});return n.createElement("div",{className:b["property-editor-actions"]},n.createElement(Ie,{variant:"link",className:L(b["property-editor-cancel"],M["property-editor-cancel"]),onClick:l},u.cancelActionText),n.createElement(Ie,{className:M["property-editor-submit"],onClick:d},u.applyActionText))}const ko=300,fo=200,yo=n.forwardRef((e,o)=>{var t;const{value:l,onChange:i,onFocus:u,onBlur:d,onLoadItems:c,options:r,statusType:s="finished",placeholder:a,disabled:p,ariaLabel:m,enteredTextLabel:v,onKeyDown:_,virtualScroll:k,expandToViewport:T,customForm:h,filterText:F,onOptionClick:G,hideEnteredTextOption:O,searchResultsId:g,onCloseDropdown:A}=e,C=ke(e,["value","onChange","onFocus","onBlur","onLoadItems","options","statusType","placeholder","disabled","ariaLabel","enteredTextLabel","onKeyDown","virtualScroll","expandToViewport","customForm","filterText","onOptionClick","hideEnteredTextOption","searchResultsId","onCloseDropdown"]),w=F===void 0?l:F,S=z.useRef(null),D=z.useRef(null),U=Ue(D,o),N=z.useMemo(()=>Xe(r||[],w),[r,w]),[K,P]=Bt({options:N,filterValue:l,filterText:w,filteringType:"manual",enteredTextLabel:v,hideEnteredTextLabel:O,onSelectItem:q=>{var he;const Se=q.value||"";me(i,{value:Se}),Ce(G,q)?P.resetHighlightWithKeyboard():(he=D.current)===null||he===void 0||he.close()}}),R=Wt({options:r,statusType:s,onLoadItems:q=>me(c,q)}),B=q=>{P.resetHighlightWithKeyboard(),me(i,q.detail)},ee=q=>{R.fireLoadMoreOnInputChange(q.detail.value)},f=()=>{R.fireLoadMoreOnInputFocus(),Ce(u,null)},j=()=>{Ce(d,null)},J=q=>{Ce(_,q.detail)},ce=()=>{var q;P.moveHighlightWithKeyboard(1),S.current&&((q=Yt(S.current))===null||q===void 0||q.focus())},ye=()=>{P.moveHighlightWithKeyboard(-1)},oe=()=>P.selectHighlightedOptionWithKeyboard(),xe=()=>{P.resetHighlightWithKeyboard(),A==null||A()},Ee=()=>{var q;R.fireLoadMoreOnRecoveryClick(),(q=D.current)===null||q===void 0||q.focus()},X=Z("input"),pe=(t=C.controlId)!==null&&t!==void 0?t:X,se=Z("list"),ae=Z("footer"),ge=Z(),ie=K.highlightedOption?ge:void 0,re=!l&&!K.items.length,Y=Vt(Object.assign(Object.assign({},e),{isEmpty:re,onRecoveryClick:Ee,hasRecoveryCallback:!!c}));let Te=null;return h?Te=n.createElement("div",{ref:S,className:b["custom-content-wrapper"]},h.content):K.items.length>0&&(Te=n.createElement(Qt,{statusType:s,autosuggestItemsState:K,autosuggestItemsHandlers:P,highlightedOptionId:ie,highlightText:w,listId:se,controlId:pe,handleLoadMore:R.fireLoadMoreOnScroll,hasDropdownStatus:Y.content!==null,virtualScroll:k,listBottom:Y.isSticky?null:n.createElement($e,{content:Y.content,id:ae}),ariaDescribedby:Y.content?ae:void 0})),n.createElement(Ut,Object.assign({ref:U},C,{className:L(Jt.root,b.input),value:l,onChange:B,onFocus:f,onBlur:j,onKeyDown:J,controlId:pe,placeholder:a,disabled:p,ariaLabel:m,expandToViewport:T,ariaControls:se,ariaActivedescendant:ie,ariaDescribedby:kt(g,C.ariaDescribedby),dropdownExpanded:K.items.length>1||Y.content!==null||!!h,dropdownContentKey:h?"custom":"options",dropdownContent:Te,dropdownFooter:Y.isSticky&&Y.content&&!h?n.createElement($e,{content:Y.content,hasItems:K.items.length>=1,id:ae}):h?h.footer:null,dropdownWidth:h?fo:ko,dropdownContentFocusable:!!h,onCloseDropdown:xe,onDelayedInput:ee,onPressArrowDown:ce,onPressArrowUp:ye,onPressEnter:oe,loopFocus:!!h||Y.hasRecoveryButton}))}),To=yo;const V={root:"awsui_root_19bso_1vgkt_153","inner-root":"awsui_inner-root_19bso_1vgkt_154","has-groups":"awsui_has-groups_19bso_1vgkt_187","compact-mode":"awsui_compact-mode_19bso_1vgkt_191",token:"awsui_token_19bso_1vgkt_200","inner-token":"awsui_inner-token_19bso_1vgkt_201",grouped:"awsui_grouped_19bso_1vgkt_214",list:"awsui_list_19bso_1vgkt_226","show-operation":"awsui_show-operation_19bso_1vgkt_237",select:"awsui_select_19bso_1vgkt_243","inner-select":"awsui_inner-select_19bso_1vgkt_244","token-content":"awsui_token-content_19bso_1vgkt_248","token-content-grouped":"awsui_token-content-grouped_19bso_1vgkt_254","inner-token-content":"awsui_inner-token-content_19bso_1vgkt_259","edit-button":"awsui_edit-button_19bso_1vgkt_264","dismiss-button":"awsui_dismiss-button_19bso_1vgkt_265","inner-dismiss-button":"awsui_inner-dismiss-button_19bso_1vgkt_266","token-disabled":"awsui_token-disabled_19bso_1vgkt_324"},ho=z.forwardRef((e,o)=>{var{tokens:t,showOperation:l,operation:i,groupOperation:u,andText:d,orText:c,groupAriaLabel:r,operationAriaLabel:s,groupEditAriaLabel:a,disabled:p=!1,onChangeOperation:m,onChangeGroupOperation:v,onDismissToken:_,editorContent:k,editorHeader:T,editorDismissAriaLabel:h,editorExpandToViewport:F,onEditorOpen:G,hasGroups:O,popoverSize:g}=e,A=ke(e,["tokens","showOperation","operation","groupOperation","andText","orText","groupAriaLabel","operationAriaLabel","groupEditAriaLabel","disabled","onChangeOperation","onChangeGroupOperation","onDismissToken","editorContent","editorHeader","editorDismissAriaLabel","editorExpandToViewport","onEditorOpen","hasGroups","popoverSize"]);const[C,w]=z.useState(null),S=Qe({nextFocusIndex:C,onFocusMoved:N=>{N.focus(),w(null)},listItemSelector:`.${V["inner-root"]}`,fallbackSelector:`.${V.root}`}),D=z.useRef(null),U={content:k,triggerType:"text",header:T,size:g,position:"bottom",dismissAriaLabel:h,renderWithPortal:F,__onOpen:G,__closeAnalyticsAction:"editClose"};return z.useImperativeHandle(o,()=>({closeEditor:()=>{var N;return(N=D.current)===null||N===void 0?void 0:N.dismissPopover()}})),n.createElement(mt,Object.assign({ref:S,ariaLabel:t.length===1?t[0].ariaLabel:r,operation:l&&n.createElement(vt,{operation:i,onChange:m,ariaLabel:s,andText:d,orText:c,parent:!0,disabled:p}),tokenAction:t.length===1?n.createElement(gt,{ariaLabel:t[0].dismissAriaLabel,onClick:()=>_(0),parent:!0,disabled:p}):n.createElement(lt,Object.assign({ref:D},U,{triggerType:"filtering-token"}),n.createElement(Lo,{ariaLabel:a,disabled:p})),parent:!0,grouped:t.length>1,disabled:p,hasGroups:O},bt(A)),t.length===1?n.createElement(lt,Object.assign({ref:D},U),n.createElement("span",Object.assign({},ve({action:"editStart"})),t[0].content)):n.createElement("ul",{className:V.list},t.map((N,K)=>n.createElement("li",{key:K},n.createElement(mt,{ariaLabel:N.ariaLabel,operation:K!==0&&n.createElement(vt,{operation:u,onChange:v,ariaLabel:s,andText:d,orText:c,parent:!1,disabled:p}),tokenAction:n.createElement(gt,{ariaLabel:N.dismissAriaLabel,onClick:()=>{_(K),w(K)},parent:!1,disabled:p}),parent:!1,grouped:!1,disabled:p,hasGroups:!1},N.content)))))}),wo=ho,mt=z.forwardRef((e,o)=>{var{ariaLabel:t,children:l,operation:i,tokenAction:u,parent:d,grouped:c,disabled:r,hasGroups:s}=e,a=ke(e,["ariaLabel","children","operation","tokenAction","parent","grouped","disabled","hasGroups"]);const p=z.useRef(null),m=Ue(o,p),v=Zt(p)==="compact";return n.createElement("div",Object.assign({ref:m,className:L(d?L(V.root,M["filtering-token"]):L(V["inner-root"],M["filtering-token-inner"]),s&&V["has-groups"],v&&V["compact-mode"]),role:"group","aria-label":t},bt(a)),i,n.createElement("div",{className:L(d?V.token:V["inner-token"],!!i&&V["show-operation"],c&&V.grouped,r&&V["token-disabled"]),"aria-disabled":r},n.createElement("div",{className:L(d?L(V["token-content"],M["filtering-token-content"]):L(V["inner-token-content"],M["filtering-token-inner-content"]),c&&V["token-content-grouped"])},l),u))});function vt({operation:e,onChange:o,ariaLabel:t,andText:l,orText:i,parent:u,disabled:d}){return n.createElement(Je,{__inFilteringToken:u?"root":"nested",className:L(u?L(V.select,M["filtering-token-select"]):L(V["inner-select"],M["filtering-token-inner-select"])),options:[{value:"and",label:l},{value:"or",label:i}],selectedOption:{value:e,label:e==="and"?l:i},onChange:c=>o(c.detail.selectedOption.value),disabled:d,ariaLabel:t})}function gt({ariaLabel:e,onClick:o,parent:t,disabled:l}){return n.createElement("button",Object.assign({type:"button",className:L(t?L(V["dismiss-button"],M["filtering-token-dismiss-button"]):L(V["inner-dismiss-button"],M["filtering-token-inner-dismiss-button"])),"aria-label":e,onClick:o,disabled:l},ve({action:"dismiss"})),n.createElement(ft,{name:"close"}))}function Lo({ariaLabel:e,disabled:o}){return n.createElement("button",{type:"button",className:L(V["edit-button"],M["filtering-token-edit-button"]),"aria-label":e,disabled:o},n.createElement(ft,{name:"edit"}))}function Oo({property:e,onChangePropertyKey:o,asyncProps:t,filteringProperties:l,onLoadItems:i,customGroupsText:u,i18nStrings:d,freeTextFiltering:c}){var r;const s=Oe(i),a=t?Object.assign(Object.assign({},t),s):{},p=We(l,u,d,({propertyKey:v,propertyLabel:_})=>({value:v,label:_,dontCloseOnSelect:!0})),m={label:d.allPropertiesLabel,value:void 0};return c.disabled||p.unshift(m),n.createElement(Je,Object.assign({options:p,selectedOption:e?{value:(r=e.propertyKey)!==null&&r!==void 0?r:void 0,label:e.propertyLabel}:m,onChange:v=>o(v.detail.selectedOption.value)},a))}function xo({property:e,operator:o,onChangeOperator:t,i18nStrings:l,freeTextFiltering:i,triggerVariant:u}){const d=(e?fe(e):i.operators).map(c=>({value:c,label:c,description:Be(c,l)}));return n.createElement(Je,{options:d,triggerVariant:u,selectedOption:o?{value:o,label:o,description:Be(o,l)}:null,onChange:c=>t(c.detail.selectedOption.value)})}function Eo(e){const{property:o,operator:t,value:l,onChangeValue:i}=e,u=(o==null?void 0:o.propertyKey)&&t&&(o==null?void 0:o.getValueFormRenderer(t));return u?n.createElement(u,{value:l,onChange:i,operator:t}):o&&t&&o.getTokenType(t)==="enum"?n.createElement(Co,Object.assign({},e,{property:o,operator:t})):n.createElement(Ao,Object.assign({},e))}function Ao({property:e,operator:o,value:t,onChangeValue:l,asyncProps:i,filteringOptions:u,onLoadItems:d,i18nStrings:c}){var r;const s=(t??"")+"",a=e?u.filter(_=>{var k;return((k=_.property)===null||k===void 0?void 0:k.propertyKey)===e.propertyKey}).map(({label:_,value:k})=>({label:_,value:k})):[],p=Oe(d,"",e==null?void 0:e.externalProperty,s,o),m=e!=null&&e.propertyKey?Object.assign(Object.assign({},p),i):{empty:i.empty},[v]=a.filter(_=>_.value===s);return n.createElement(Xt,Object.assign({enteredTextLabel:c.enteredTextLabel,value:(r=v==null?void 0:v.label)!==null&&r!==void 0?r:s,clearAriaLabel:c.clearAriaLabel,onChange:_=>l(_.detail.value),disabled:!o,options:a},m,{virtualScroll:!0}))}function Co({property:e,operator:o,value:t,onChangeValue:l,asyncProps:i,filteringOptions:u,onLoadItems:d}){const c=u.filter(m=>{var v;return((v=m.property)===null||v===void 0?void 0:v.propertyKey)===e.propertyKey}).map(({label:m,value:v})=>({label:m,value:v})),r=Oe(d,"",e.externalProperty,void 0,o),s=Object.assign(Object.assign({statusType:"finished"},r),i),a=t?Array.isArray(t)?t:[t]:[],p=c.filter(m=>a.includes(m.value));return n.createElement("div",{className:b["token-editor-multiselect-wrapper"]},n.createElement("div",{className:b["token-editor-multiselect-wrapper-inner"]},n.createElement(Ht,Object.assign({filteringType:"auto",selectedOptions:p,onChange:m=>l(m.detail.selectedOptions.map(v=>v.value)),options:c.length>0?[{options:c,label:e.groupValuesLabel}]:[]},s,{inlineTokens:!0,hideTokens:!0,keepOpen:!0}))))}function Io({supportsGroups:e,asyncProperties:o,asyncProps:t,customGroupsText:l,freeTextFiltering:i,filteringProperties:u,filteringOptions:d,i18nStrings:c,onLoadItems:r,onSubmit:s,onDismiss:a,tokensToCapture:p,onTokenCapture:m,onTokenRelease:v,tempGroup:_,onChangeTempGroup:k}){var T;const[h,F]=z.useState(null),G=Qe({nextFocusIndex:h,onFocusMoved:g=>{g.focus(),F(null)},listItemSelector:`.${b["token-editor-field-property"]}`,fallbackSelector:`.${b["token-editor-add-token"]}`}),O=_.map((g,A)=>{const C=P=>{var R;const B=[..._];B[A]=P,((R=P.property)===null||R===void 0?void 0:R.getTokenType(P.operator))==="enum"&&P.value===null&&(P.value=[]),k(B)},w=g.property,S=P=>{var R;const B=u.reduce((J,ce)=>ce.propertyKey===P?ce:J,void 0),ee=B?fe(B):i.operators,f=g.operator&&ee.indexOf(g.operator)!==-1?g.operator:ee[0],j=(R=u.find(J=>J.propertyKey===P))!==null&&R!==void 0?R:null;C(Object.assign(Object.assign({},g),{property:j,operator:f,value:null}))},D=g.operator,U=P=>{const R=w==null?void 0:w.getTokenType(D),B=w==null?void 0:w.getTokenType(P),f=R!==B?null:g.value;C(Object.assign(Object.assign({},g),{operator:P,value:f}))},N=g.value;return{token:g,property:w,onChangePropertyKey:S,operator:D,onChangeOperator:U,value:N,onChangeValue:P=>{C(Object.assign(Object.assign({},g),{value:P}))}}});return n.createElement("div",{className:b["token-editor"],ref:G},n.createElement(Po,{supportsGroups:e,tokens:O.map(g=>g.token),onRemove:g=>{const A=_.filter((C,w)=>w!==g);k(A),F(g)},onRemoveFromGroup:g=>{const A=_[g],C=_.filter((w,S)=>S!==g);k(C),v(A),F(g)},onSubmit:s,renderProperty:g=>n.createElement(Oo,{property:O[g].property,onChangePropertyKey:O[g].onChangePropertyKey,asyncProps:o?t:null,filteringProperties:u,onLoadItems:r,customGroupsText:l,i18nStrings:c,freeTextFiltering:i}),renderOperator:g=>n.createElement(xo,{property:O[g].property,operator:O[g].operator,onChangeOperator:O[g].onChangeOperator,i18nStrings:c,freeTextFiltering:i,triggerVariant:e?"label":"option"}),renderValue:g=>n.createElement(Eo,{property:O[g].property,operator:O[g].operator,value:O[g].value,onChangeValue:O[g].onChangeValue,asyncProps:t,filteringOptions:d,onLoadItems:r,i18nStrings:c}),i18nStrings:c}),e&&n.createElement("div",{className:L(b["token-editor-add-token"],M["token-editor-token-add-actions"])},n.createElement(He,{variant:"normal",ariaLabel:c.tokenEditorAddTokenActionsAriaLabel,items:p.map((g,A)=>{var C,w,S,D;return{id:A.toString(),text:(w=(C=c.tokenEditorAddExistingTokenLabel)===null||C===void 0?void 0:C.call(c,g))!==null&&w!==void 0?w:"",ariaLabel:(D=(S=c.tokenEditorAddExistingTokenAriaLabel)===null||S===void 0?void 0:S.call(c,g))!==null&&D!==void 0?D:""}}),onItemClick:({detail:g})=>{const A=parseInt(g.id);!isNaN(A)&&p[A]&&(k([..._,Object.assign({},p[A])]),F(O.length),m(p[A]))},disabled:p.length===0,showMainActionOnly:p.length===0,mainAction:{text:(T=c.tokenEditorAddNewTokenLabel)!==null&&T!==void 0?T:"",onClick:()=>{var g;const A=_[_.length-1],C=A?A.property:null,w=(g=C==null?void 0:C.defaultOperator)!==null&&g!==void 0?g:":";k([..._,{property:C,operator:w,value:null}]),F(O.length)}}})),n.createElement("div",{className:b["token-editor-actions"]},n.createElement("span",Object.assign({},ve({action:"editCancel"})),n.createElement(Ie,{formAction:"none",variant:"link",className:L(b["token-editor-cancel"],M["token-editor-cancel"]),onClick:a},c.cancelActionText)),n.createElement("span",Object.assign({},ve({action:"editConfirm"})),n.createElement(Ie,{className:L(b["token-editor-submit"],M["token-editor-submit"]),formAction:"none",onClick:s},c.applyActionText))))}function Po({tokens:e,supportsGroups:o,onRemove:t,onRemoveFromGroup:l,onSubmit:i,renderProperty:u,renderOperator:d,renderValue:c,i18nStrings:r}){const a=eo()||!o,p=Z(),m=Z(),v=Z(),_=n.createElement("div",{className:b["token-editor-grid-group"]},n.createElement("div",{id:p,className:b["token-editor-grid-header"]},r.propertyText),n.createElement("div",{id:m,className:b["token-editor-grid-header"]},r.operatorText),n.createElement("div",{id:v,className:b["token-editor-grid-header"]},r.valueText),n.createElement("div",{className:b["token-editor-grid-header"]}));return n.createElement("form",{className:L(b["token-editor-grid"],a&&b["token-editor-narrow"],b["token-editor-form"]),onSubmit:k=>{k.preventDefault(),i()}},!a&&_,e.map((k,T)=>{var h,F,G,O,g,A;return n.createElement("div",{key:T,role:"group","aria-label":r.formatToken(k).formattedText,className:L(b["token-editor-grid-group"],o&&b["token-editor-supports-groups"])},n.createElement("div",{className:L(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.propertyText,labelId:p,className:L(b["token-editor-field-property"],M["token-editor-field-property"]),index:T},u(T))),n.createElement("div",{className:L(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.operatorText,labelId:m,className:L(b["token-editor-field-operator"],M["token-editor-field-operator"]),index:T},d(T))),n.createElement("div",{className:L(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement(Ke,{isNarrow:a,label:r.valueText,labelId:v,className:L(b["token-editor-field-value"],M["token-editor-field-value"]),index:T},c(T))),o&&n.createElement("div",{className:L(b["token-editor-grid-cell"],a&&b["token-editor-narrow"])},n.createElement("div",{className:b["token-editor-remove-token"]},n.createElement(Fo,{isNarrow:a,ariaLabel:(F=(h=r.tokenEditorTokenActionsAriaLabel)===null||h===void 0?void 0:h.call(r,k))!==null&&F!==void 0?F:"",mainActionAriaLabel:(O=(G=r.tokenEditorTokenRemoveAriaLabel)===null||G===void 0?void 0:G.call(r,k))!==null&&O!==void 0?O:"",disabled:e.length===1,items:[{id:"remove",text:(g=r.tokenEditorTokenRemoveLabel)!==null&&g!==void 0?g:"",disabled:k.standaloneIndex!==void 0},{id:"remove-from-group",text:(A=r.tokenEditorTokenRemoveFromGroupLabel)!==null&&A!==void 0?A:""}],onItemClick:C=>{switch(C){case"remove":return t(T);case"remove-from-group":return l(T)}},index:T}))))}))}function Ke({isNarrow:e,label:o,labelId:t,children:l,className:i,index:u}){return e?n.createElement(st,{label:o,className:i,stretch:!0,"data-testindex":u},l):n.createElement(_t.Provider,{value:{ariaLabelledby:t}},n.createElement(st,{className:i,"data-testindex":u},l))}function Fo({isNarrow:e,ariaLabel:o,mainActionAriaLabel:t,disabled:l,items:i,onItemClick:u,index:d}){return e?n.createElement(He,{variant:"normal",ariaLabel:o,items:i.slice(1),onItemClick:({detail:c})=>u(c.id),disabled:l,mainAction:{text:i[0].text,onClick:()=>u(i[0].id),disabled:l,ariaLabel:t},className:M["token-editor-token-remove-actions"],"data-testindex":d}):n.createElement(He,{variant:"icon",ariaLabel:o,items:i,onItemClick:({detail:c})=>u(c.id),disabled:l,className:M["token-editor-token-remove-actions"],"data-testindex":d})}const Fe={"token-trigger":"awsui_token-trigger_1b6uy_xiape_5","search-field":"awsui_search-field_1b6uy_xiape_6"},So=({query:e,onUpdateToken:o,onUpdateOperation:t,onRemoveToken:l,tokenIndex:i,filteringProperties:u,filteringOptions:d,asyncProps:c,onLoadItems:r,i18nStrings:s,asyncProperties:a,hideOperations:p,customGroupsText:m,disabled:v,freeTextFiltering:_,expandToViewport:k,enableTokenGroups:T})=>{var h,F,G,O;const g=z.useRef(null),A=e.tokens.some(f=>"operation"in f),C=i===0,w=e.tokens[i],S=Le([w]).map(f=>Object.assign(Object.assign({},f),{standaloneIndex:void 0})),D=e.operation,U="operation"in w?w.operation:D==="and"?"or":"and",[N,K]=z.useState(S),P=N.map(f=>f.standaloneIndex).filter(f=>f!==void 0),R=[];for(let f=0;f<e.tokens.length;f++){const j=e.tokens[f];"operator"in j&&j!==w&&!P.includes(f)&&R.push(j)}const[B,ee]=z.useState([]);return R.push(...B),n.createElement(wo,Object.assign({ref:g,tokens:S.map(f=>{const j=s.formatToken(f);return{content:n.createElement("span",{className:L(b["token-trigger"],Fe["token-trigger"])},n.createElement(No,{token:j,allProperties:f.property===null})),ariaLabel:j.formattedText,dismissAriaLabel:s.removeTokenButtonAriaLabel(f)}}),showOperation:!C&&!p,operation:D,andText:(h=s.operationAndText)!==null&&h!==void 0?h:"",orText:(F=s.operationOrText)!==null&&F!==void 0?F:"",operationAriaLabel:(G=s.tokenOperatorAriaLabel)!==null&&G!==void 0?G:"",onChangeOperation:t,onDismissToken:f=>{if(S.length===1)l();else{const j=S.filter((ce,ye)=>ye!==f),J=j.length===1?j[0]:{operation:U,tokens:j};o(J,[])}},disabled:v,editorContent:n.createElement(Io,{supportsGroups:T,filteringProperties:u,filteringOptions:d,tempGroup:N,onChangeTempGroup:K,tokensToCapture:R,onTokenCapture:f=>ee(j=>j.filter(J=>J!==f)),onTokenRelease:f=>{f.standaloneIndex===void 0&&ee(j=>[...j,f])},asyncProps:c,onLoadItems:r,i18nStrings:s,asyncProperties:a,customGroupsText:m,freeTextFiltering:_,onDismiss:()=>{var f;(f=g.current)===null||f===void 0||f.closeEditor()},onSubmit:()=>{var f;const j=N.length===1?N[0]:{operation:U,tokens:N};o(j,B),(f=g.current)===null||f===void 0||f.closeEditor()}}),editorHeader:(O=s.editTokenHeader)!==null&&O!==void 0?O:"",editorDismissAriaLabel:s.dismissAriaLabel,editorExpandToViewport:!!k,onEditorOpen:()=>{K(S),ee([])},groupOperation:U,onChangeGroupOperation:f=>o({operation:f,tokens:S},[]),groupAriaLabel:s.groupAriaLabel({operation:U,tokens:S}),groupEditAriaLabel:s.groupEditAriaLabel({operation:U,tokens:S}),hasGroups:A,popoverSize:T?"content":"large"},ve({detail:{tokenPosition:`${i+1}`,tokenLabel:`.${Fe["token-trigger"]}`}})))},No=({token:{propertyLabel:e,operator:o,value:t},allProperties:l})=>{e&&(e+=" ");const u=o===":"&&l?"":o+" ";return n.createElement(n.Fragment,null,l?"":e,n.createElement("span",{className:b["token-operator"]},u),t)},Ro=n.forwardRef((e,o)=>{var t,{disabled:l,countText:i,query:u,hideOperations:d,onChange:c,filteringProperties:r,filteringOptions:s,customGroupsText:a,disableFreeTextFiltering:p,freeTextFiltering:m,onLoadItems:v,virtualScroll:_,customControl:k,customFilterActions:T,filteringPlaceholder:h,filteringAriaLabel:F,filteringEmpty:G,filteringLoadingText:O,filteringFinishedText:g,filteringErrorText:A,filteringRecoveryText:C,filteringConstraintText:w,filteringStatusType:S,asyncProperties:D,tokenLimit:U,expandToViewport:N,tokenLimitShowFewerAriaLabel:K,tokenLimitShowMoreAriaLabel:P,enableTokenGroups:R,loading:B=!1,__internalRootRef:ee}=e,f=ke(e,["disabled","countText","query","hideOperations","onChange","filteringProperties","filteringOptions","customGroupsText","disableFreeTextFiltering","freeTextFiltering","onLoadItems","virtualScroll","customControl","customFilterActions","filteringPlaceholder","filteringAriaLabel","filteringEmpty","filteringLoadingText","filteringFinishedText","filteringErrorText","filteringRecoveryText","filteringConstraintText","filteringStatusType","asyncProperties","tokenLimit","expandToViewport","tokenLimitShowFewerAriaLabel","tokenLimitShowMoreAriaLabel","enableTokenGroups","loading","__internalRootRef"]);const[j,J]=z.useState(null),ce=Qe({nextFocusIndex:j,onFocusMoved:(y,x)=>{var I;x==="fallback"?(I=oe.current)===null||I===void 0||I.focus({preventDropdown:!0}):y.focus(),J(null)},listItemSelector:`.${it["list-item"]}`,showMoreSelector:`.${it.toggle}`,fallbackSelector:`.${b.input}`}),ye=Ue(ce,ee),oe=z.useRef(null),xe=z.useRef(null),Ee=At(f),X=ao(f.i18nStrings);z.useImperativeHandle(o,()=>({focus:()=>{var y;return(y=oe.current)===null||y===void 0?void 0:y.focus()}}),[]);const[pe,se]=z.useState(""),{internalProperties:ae,internalOptions:ge,internalQuery:ie,internalFreeText:re}=(()=>{var y,x;const I=r.reduce((H,E)=>{var le,De,qe,Ve,ze;const Me=((le=E==null?void 0:E.operators)!==null&&le!==void 0?le:[]).reduce((W,Q)=>typeof Q=="object"?W.set(Q.operator,Q):W,new Map);return H.set(E.key,{propertyKey:E.key,propertyLabel:(De=E==null?void 0:E.propertyLabel)!==null&&De!==void 0?De:"",groupValuesLabel:(qe=E==null?void 0:E.groupValuesLabel)!==null&&qe!==void 0?qe:"",propertyGroup:E==null?void 0:E.group,operators:((Ve=E==null?void 0:E.operators)!==null&&Ve!==void 0?Ve:[]).map(W=>typeof W=="string"?W:W.operator),defaultOperator:(ze=E==null?void 0:E.defaultOperator)!==null&&ze!==void 0?ze:"=",getTokenType:W=>{var Q,te;return W&&(te=(Q=Me.get(W))===null||Q===void 0?void 0:Q.tokenType)!==null&&te!==void 0?te:"value"},getValueFormatter:W=>{var Q,te;return W&&(te=(Q=Me.get(W))===null||Q===void 0?void 0:Q.format)!==null&&te!==void 0?te:null},getValueFormRenderer:W=>{var Q,te;return W&&(te=(Q=Me.get(W))===null||Q===void 0?void 0:Q.form)!==null&&te!==void 0?te:null},externalProperty:E}),H},new Map),ne=H=>{var E;return(E=I.get(H))!==null&&E!==void 0?E:null},ue=s.map(H=>{var E,le;return{property:ne(H.propertyKey),value:H.value,label:(le=(E=H.label)!==null&&E!==void 0?E:H.value)!==null&&le!==void 0?le:""}});function de(H,E){return"operation"in H?{operation:H.operation,tokens:H.tokens.map(le=>de(le))}:{standaloneIndex:E,property:H.propertyKey?ne(H.propertyKey):null,operator:H.operator,value:H.value}}const we={operation:u.operation,tokens:(R&&u.tokenGroups?u.tokenGroups:u.tokens).map(de)},Et={disabled:p,operators:(y=m==null?void 0:m.operators)!==null&&y!==void 0?y:[":","!:"],defaultOperator:(x=m==null?void 0:m.defaultOperator)!==null&&x!==void 0?x:":"};return{internalProperties:[...I.values()],internalOptions:ue,internalQuery:we,internalFreeText:Et}})(),{addToken:Y,updateToken:Te,updateOperation:q,removeToken:he,removeAllTokens:Se}=lo({query:ie,filteringOptions:ge,onChange:c,enableTokenGroups:R}),be=Ge(pe,ae,re),Tt=uo(be,ae,ge,a,X),ht=y=>{const x=Ge(y,ae,re);let I;switch(x.step){case"property":{I={property:x.property,operator:x.operator,value:x.value};break}case"free-text":{I={property:null,operator:x.operator||re.defaultOperator,value:x.value};break}case"operator":{I={property:null,operator:re.defaultOperator,value:y};break}}re.disabled&&!I.property||(Y(I),se(""))},Ye=(y,x)=>{const I={filteringProperty:void 0,filteringText:x,filteringOperator:void 0};return y.step==="property"&&(I.filteringProperty=y.property.externalProperty,I.filteringText=y.value,I.filteringOperator=y.operator),I},Ae=Ye(be,pe),Ze=Oe(v,Ae.filteringText,Ae.filteringProperty,Ae.filteringText,Ae.filteringOperator),Ne={empty:G,loadingText:O,finishedText:g,errorText:A,recoveryText:C,statusType:S},wt=pe.length||D?Object.assign(Object.assign({},Ze),Ne):{},Lt=y=>{var x;const{detail:I}=y,ne=I.value||"";if(!ne)return;if(!("keepOpenOnSelect"in I)){ht(ne);return}y.preventDefault();const ue=Ge(ne,ae,re),de=Ye(ue,ne);if(ue.step==="operator"){const we=fe(ue.property);ne.trim()===ue.property.propertyLabel&&we.length===1&&(de.filteringProperty=(x=ue.property.externalProperty)!==null&&x!==void 0?x:void 0,de.filteringOperator=we[0],de.filteringText="",se(ue.property.propertyLabel+" "+we[0]+" "))}me(v,Object.assign(Object.assign({},de),{firstPage:!0,samePage:!1}))};Nt({searchQuery:u,countText:i,loading:B,announceCallback:()=>{var y;(y=xe.current)===null||y===void 0||y.reannounce()}});const $=be.step==="property"?be:null,_e=$?$.property.propertyKey+":"+$.operator:"",[et,tt]=z.useState({}),Re=_e in et?et[_e]:null,ot=y=>tt({[_e]:y}),je=$&&$.property.getValueFormRenderer($.operator),Ot=($==null?void 0:$.property.getTokenType($.operator))==="enum",rt=Z("property-filter-search-results"),nt=Z("property-filter-constraint"),xt=w?kt(f.ariaDescribedby,nt):f.ariaDescribedby,at=!!(!((t=ie.tokens)===null||t===void 0)&&t.length)&&!l&&!!i;return n.createElement("div",Object.assign({},Ee,{className:L(Ee.className,b.root),ref:ye}),n.createElement("div",{className:L(b["search-field"],Fe["search-field"])},k&&n.createElement("div",{className:b["custom-control"]},k),n.createElement("div",{className:b["input-wrapper"]},n.createElement(To,Object.assign({ref:oe,virtualScroll:_,enteredTextLabel:X.enteredTextLabel,ariaLabel:F??X.filteringAriaLabel,placeholder:h??X.filteringPlaceholder,ariaLabelledby:f.ariaLabelledby,ariaDescribedby:xt,controlId:f.controlId,value:pe,disabled:l},Tt,{onChange:y=>se(y.detail.value),empty:G},wt,{expandToViewport:N,onOptionClick:Lt,customForm:je||Ot?{content:je?n.createElement(go,{key:_e,property:$.property,operator:$.operator,filter:$.value,operatorForm:je,value:Re,onChange:ot}):n.createElement(bo,{key:_e,property:$.property,filter:$.value,value:Re,onChange:ot,asyncProps:Ne,filteringOptions:ge,onLoadItems:Ze.onLoadItems}),footer:n.createElement(_o,{key:_e,property:$.property,operator:$.operator,value:Re,i18nStrings:X,onCancel:()=>{var y,x;se(""),(y=oe.current)===null||y===void 0||y.close(),(x=oe.current)===null||x===void 0||x.focus({preventDropdown:!0})},onSubmit:y=>{var x,I;Y(y),se(""),(x=oe.current)===null||x===void 0||x.focus({preventDropdown:!0}),(I=oe.current)===null||I===void 0||I.close()}})}:void 0,onCloseDropdown:()=>tt({}),hideEnteredTextOption:re.disabled&&be.step!=="property",clearAriaLabel:X.clearAriaLabel,searchResultsId:at?rt:void 0})),at?n.createElement("div",{className:b.results},n.createElement(Rt,{id:rt,renderLiveRegion:!B,ref:xe},i)):null)),w&&n.createElement("div",{id:nt,className:b.constraint},w),ie.tokens&&ie.tokens.length>0&&n.createElement("div",{className:b.tokens},n.createElement(St,{size:"xs",direction:"horizontal"},n.createElement(Ft,{alignment:"inline",limit:U,items:ie.tokens,limitShowFewerAriaLabel:K,limitShowMoreAriaLabel:P,renderItem:(y,x)=>n.createElement(So,{query:ie,tokenIndex:x,onUpdateToken:(I,ne)=>{Te(x,I,ne)},onUpdateOperation:q,onRemoveToken:()=>{he(x),J(x)},filteringProperties:ae,filteringOptions:ge,asyncProps:Ne,onLoadItems:v,i18nStrings:X,asyncProperties:D,hideOperations:d,customGroupsText:a,freeTextFiltering:re,disabled:l,expandToViewport:N,enableTokenGroups:R}),i18nStrings:{limitShowFewer:X.tokenLimitShowFewer,limitShowMore:X.tokenLimitShowMore},after:T?n.createElement("div",{className:b["custom-filter-actions"]},T):n.createElement("span",Object.assign({},ve({action:"clearFilters"})),n.createElement(Pt,{formAction:"none",onClick:()=>{var y;Se(),(y=oe.current)===null||y===void 0||y.focus({preventDropdown:!0})},className:b["remove-all"],disabled:l},X.clearFiltersText))}))))}),jo=Ro,yt=n.forwardRef((e,o)=>{var t,{filteringProperties:l,filteringOptions:i=[],customGroupsText:u=[],enableTokenGroups:d=!1,disableFreeTextFiltering:c=!1,asyncProperties:r,expandToViewport:s,hideOperations:a=!1,tokenLimit:p,virtualScroll:m}=e,v=ke(e,["filteringProperties","filteringOptions","customGroupsText","enableTokenGroups","disableFreeTextFiltering","asyncProperties","expandToViewport","hideOperations","tokenLimit","virtualScroll"]);let _=!1,k=!1,T=!1;for(const G of l)for(const O of(t=G.operators)!==null&&t!==void 0?t:[])typeof O=="object"&&(_=_||!!O.form,k=k||O.tokenType==="enum",T=T||!!O.format);const h=Ct("PropertyFilter",{props:{asyncProperties:r,disableFreeTextFiltering:c,enableTokenGroups:d,expandToViewport:s,hideOperations:a,tokenLimit:p,virtualScroll:m},metadata:{hasCustomForms:_,hasEnumTokens:k,hasCustomFormatters:T}}),F={name:"awsui.PropertyFilter",label:`.${Fe["search-field"]} input`,properties:{disabled:`${!!v.disabled}`,queryTokensCount:`${v.query&&v.query.tokens?v.query.tokens.length:0}`}};return a&&d&&(a=!1),n.createElement(jo,Object.assign({ref:o},h,{filteringProperties:l,filteringOptions:i,customGroupsText:u,enableTokenGroups:d,disableFreeTextFiltering:c,asyncProperties:r,expandToViewport:s,hideOperations:a,tokenLimit:p,virtualScroll:m},ve({component:F}),v))});It(yt,"PropertyFilter");const pr=yt;export{pr as P};
